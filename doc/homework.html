<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Li Jingjing" />

<meta name="date" content="2020-12-18" />

<title>homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Li Jingjing</h4>
<h4 class="date">2020-12-18</h4>



<div id="a-20066-2020-09-22" class="section level1">
<h1>A-20066-2020-09-22</h1>
</div>
<div id="hw_0-use-knitr-to-produce-3-examples" class="section level1">
<h1>HW_0: Use knitr to produce 3 examples</h1>
<div id="q1-the-1st-example-should-contain-texts-and-at-least-one-figure." class="section level2">
<h2>Q1: The 1st example should contain texts and at least one figure.</h2>
</div>
<div id="answer1" class="section level2">
<h2>Answer1:</h2>
<div id="安装必要的包-knitrggplot2" class="section level3">
<h3>安装必要的包 knitr,ggplot2</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;knitr&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
</div>
<div id="加载ggplot2使用ggplot2自带的数据集diamonds" class="section level3">
<h3>加载ggplot2，使用ggplot2自带的数据集diamonds</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;ggplot2&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">data</span>(diamonds)</span></code></pre></div>
</div>
<div id="以cut切割好坏属性进行颜色划分绘制price钻石价格和carat克拉散布图" class="section level3">
<h3>以cut（切割好坏）属性进行颜色划分绘制price（钻石价格）和carat（克拉）散布图</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">qplot</span>(carat,price,<span class="dt">data =</span> diamonds,<span class="dt">colour =</span> cut)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Scatter map with cut as color scale</p>
</div>
</div>
<div id="以depth切割深度属性进行颜色划分绘制price钻石价格和carat克拉散布图" class="section level3">
<h3>以depth（切割深度）属性进行颜色划分绘制price（钻石价格）和carat（克拉）散布图</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">qplot</span>(carat,price,<span class="dt">data =</span> diamonds,<span class="dt">colour =</span> clarity)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA81BMVEUAAAAAADoAAGYAOpAAZrYfoYcnf44zMzM2XI06AAA6ADo6AGY6OmY6OpA6kNtEAVRGM35KwW1NTU1NTW5NTY5NbqtNjshmAABmADpmOgBmZmZmkJBmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQOjqQOmaQkDqQtpCQ27aQ2/+f2jqrbk2rbm6rbo6ryKur5OSr5P+2ZgC225C22/+2/9u2///Ijk3I///bkDrb/7bb/9vb///kq27k///r6+vy8vL95yX/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///9oO9g4AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAU/klEQVR4nO2diZvTxhXADUHqEFosLU23B0nbpC2kSVCOQtLAthBXyybAov//r+m8Y06NpLHXOizpfR94vXi91o837828S5tqlVbZjP0Bpi4roA5ZAXXICqhDVkAdsgLqkGMA2lU7Iw1fR7zksJcf4fO3ygqoQ1ZAHbIC6pAVUIesgDpkBdQhK6AOWQF1yFCAyrJM0jSFL4UQmRT5LMt2SZJku518ulxAEk1RlCApEhICCcGTNEtAMhSmRMIslwCI0BhAogkQUdJ8DKH5ApJMaoDSGwHabrczAoRQGFDCNihPmQ/boMxZYZpQA6Dt1iY0E0Bkg1IJIgdRKiREQoSE4uKrUOAd5wiIVUiiQUKpWma0xCQiDWhnAwq/48wAMSElaZEaEcAGVQjXm8+n6R3nZYMsFcqLRK6ooiiQi4QCjMBqW+sqBtD8vBiZoV1ObMgGgeFBQsJxXfsCYm1q/2hXHz6pPf/5h30ubgBARbHLiVBR5Dn7MLQ9KX2x04QitYb5IKH2j+YDCn+rTQYBBIS0lZbuS7o0AUqkdSjzf3RJgAoApPZBqYQjeOeDjFKL0DEBXT/ebO4Qjau7m83mfnV174vN7e8//FI+u/9M/lN1cWcSgIBPUSa2KCwSkLOF3u+w2mqDrh/fqd6ePwRA8FBd3P7x6i4BA2aXt3+UL3k4BUC7HfDJCUyiTxagPZnZBh0CqNWLqXUkH395SY9Xdx9qQMju3o8jAyotN096gyvMMEqIlDjIBrUDAhXRoC7lEruFYBQgWF5xK2wAQLSRllRK5iO0EKDQ9vmIgN6e33qiwejHe/+OW2F9pp5LhxAykmqUZOzo4S91kO94J2lu9vzd1hK7/ECusUtPg64f/yluhQ3i5lmF8oRUiNUmMxY6a9cg6wgWq0FgpOEPAAIFumsAodGuLjZxK6zvgJnyY7l2YMJojnHy7Ub6AEC2m38mLdBX5w8VIPkc/uFu3Aob5LAq99E5Ko8+yxMZJ1Z2ZEBdEunDejfSsLzk+UISKgt9mtcWOrMItR01zCH+aIAu7ke+sG8vBtvoHR4xIGQmueBpTJB7R5emAA15mr+6C5Y7SoZw87siQSeWKiNN7j3JOHamFWih4Q6pRnBOxaBrktqGJzXra5GA4GteZ7QFIhXSJ1XyZJrLfuGOmQEy4dbEnOXdg8auHm+eOyCT1EAVStxoR8aEMqH5GEKLAKQDrgXaIN4rkgODRz5uyK+PD+h/YTng4vr3Ykp/zEZaR11pV70CQkImI6b9F+bFMqrv2NVsUMvueXaAdkkCkFKdykg1Hj5v+FdfWQo1c0AUklY2Wghto8HDO5kf181rQIFk4ZwAFbzCIPBaMiFdviBsQGajCOEfDSiUbp4RICxYMNEODCdmlF61ZWcDYiRGgeYMqMwpZ4jhDsqHpSoMVKiv6OU+IJa5A6IlBuUvOZ3jhYqTpS4fY4NcJH3YIAoGxYWEBgKExUEQ7LDdPJug2o+iDWqDsg8g+WZhQJeb21MBBGkfKl3IhR2OFsYA+Vd/NECojiFAz259OQUNQjwlRTk4kqhP8yZIlh09cdgNaGpLDDMaFC8jQnbppnH0ywOkjxrSSpt4IpxQa4Ds9Wa94w2NdKMNmgwgjAbpCtfEbA7jAPXh5o8G6M2fX1TVq7Ozs9++qN59dvbRT5X3EAUICVEBJ2iQ8vEWG38rfSqAXgOY6vkj+Pr914+qV7/zHmIAFRSTllLwzsdU39HGWlvpoA2aMKDnD76TGvT+m6fw5N3fX4BCuQ8xgNgGkfpYSTFrqe1sPaqBmPJhFRjIxXR29qh689efqnd/e+o+yJf8SkrDTys+cNjAQmmAJLTyJGo/VFVmtR1wBUEZENCbT56CFr3+CJG4D/yylpg0pOWxwB7+qNOqSFUi2tYgZ9N4IhFFvYqeP2rSoHZABRPiYJnC43uynVlnJwvoIBvEfWI5UZJapENBGbuy1MLSYIOmDghW0/tvX7z/+lNyX/ZDN6BCxTwkHYqXpZnTD9WwOzwhQLAPevDU3wDF7YMKbYKcwhch3DUWuPoTARQpDZdQaELUSwfrqzDNYk5McZmASGiFgcgnqlcs8w8cu5O0QZHSdAm2CQIHD0sst2Nlfv3UyXmxSGm8BI4G5RQqSziiiPn4rFaBt0BAhQaU0mksFarZhyAJ+4yxTEA5m2ld/CK/xtogKsOzmSzTBqELK4s0p0NGLpzil4W7+R1rDyw00h+sgeHMPEJyCQ0H6O35BnIaEPCAZqm2kum+jXQBBcApDBYg/56oDhYhMpENAEi+fQ0QdUh98FICevv7J+0tdn0CgvJoYmQ1+jj7H9E7IHx/HxCGyiQa+XgJHQnPWlSob0A59yHYrVBmEy1sPsMBun5MZdIcUwQtGg9QXnLxXcpLLDXnDKsValBA2EIGPS4I6PpxW9V9r0WcREidVoXy9aw6fuZ5OBuEAp1RuNTOW7sSej2s8mksL6kBwapacI9huhKoB0AhL4aGR1oe8mLtbT/9n+ZxNy34NM9kHEKcuBiwiBO9GBnpzraoXk/zJQcV5VmV9kCJFwkaCRDug8gGXWxAxvFiJR81YK9ozI9uVnVW2MCA9pB+U8/gxPQ+iEabOBkxNtJD26B9pEdAuarAy1X5pjyoOhtEZxe0vLMYBoIK7eb5oKEcmRlLsVxAJm/IA96QilUn7RGCH62vtlkD4mhikgqdlU8znX423Yb6RwP2etaAzEbaHragDJG21nMH1CA6q1qYug6OdniEzM8gGv77JjItQI1nsdJMFVAn1dTiIrw1VvlV9nPRoMaIYg7b6ASj9sAndw9huOSqkA1aiBfb0UYahnbQEkupFdxB5Ln5RQEqdGo+L3Q63lIif4VZbn5ZgECLVNlUquoSvcOGf/VLAYR4uK4ME/O2DUpWQIhID3bLTa45tQGFrn6AcAenfbqqXfuNB6nBUznVkTsLSyU4jFN3AR2pqVeqbQ2Qlfbp7PrpWYPUXtoq/jWYGJDVfGm9y5GaevH3+oCstE9n10+f4Y6i1EXkiepxNicOPQjYbA7tgFmfgNy0z3hLjDwYFkgrKol3FnN3z0MBctM+owEiOgVPDjJ6Y+2DvBCHE3Lt0QahqLTPeIAoYKYGU4hcxRPVCDM0QNaPjpP2GVOD4CCW2K4eEQlnO91w9f0CstI+YwIqcg53YJE9dx9knowCyEr7jAmI0oY5D31BE4RrzalNHAfQHtJvZjXnnaIO0QMcJ6Uxig3aR3reKHIJnhr+4iiPBGIDOonE4cVm8/AiesRgByDlwdAKgXVWKY006MVOAdCzD/5z/hBmxB4FUKHyYkmCBXjmrjWOkVZYTgCQ9H7gAC+jRjZ0A1IlwEWuThpEySWkuSwPUKkTq6ofvCjcdmcNKHDUmCKg6gKWWEfFVTwgGkqh4mUqKWZiZjsbECfDmofaTgIQTn/f7MunvduHu3xUM0uqbDSwaFahqQI6TFoAcXFrmut9UKqX1g4JbU8ZEHYcBlsNYzoOdVZD9TpzXMhsghiKZabjoIwGCApiLS+PkxeCIxeiJi9IL5aWHHPVhfUMCPhknmE+gaMG3tFFE6LJC8F256iuZzyG8Qg8KxlmnTNcQNM/atD9Aiw3j4MFQg3zUZMXaB+UcAdLhjNx7K1iVTlVCtublywYGRBQcORC1OQFldPgExjNT1TtUEpnHAUyT6epQXCLIKfyPEKDGgEVBdcoKhvEs8vw0dk72zvpQQDRbY+ufvOS02OtLVGt+6A3h9sgdmDc8cw7Re5CYA/mV0v1A0j+9poG4S0RLu6r9FhrS1Snmw+OXOievKDrFiggrdcZ/wkBwhtoREHZAxAWBPiApPJU158/Uemx1paovvZBprJDmmm2PnYT3Y4JNeR3+gUk4QAklR4DaWyJ0oDwpIp1+XEDGC1psEFqsFKKDYeoQElteGIVzu/0CwjWGC4zSo9VbS1RvR01eOgLHzdSvi+mDnd0XH2/Nkiqz38/Z41B49NyQLcBRd7ULgoQe7BUDe1QI8lDtdG9Agq6+et/fi/NkEqPtbZEBfZBxwNUQgE5lW6S8pho0JZd2TiAqos/3rfSY20tUV48aN9wdDugXDXyUqOGDgolgg7x2WiAyKtzeqy1JcrVoOMZaXXXNVXaoQrJ1fy7kQHFS19GWvWK4TgKumsNmmkn0KoAbWuVm8sAxEcxts1ORkPxcSJlJwDooqM/MR4QtxqqElc6zbuAdv5eevqA/MPqTQDlGOhgQ53ySIFMDVXaWnI6gGrhjpsBovuGcpiVt4kK09YX7+rnD2iXK8E7i+mUvMiCgPyrnyYguF3rsZbYjgpf6O68aoto7PTWY3QagNQ+aN+tUMtpnia1Q1JV22dBHsyzQycB6FBp2QepAxgfVTFqT0Q0oX5P81MGpOcnJonTRMcqQw/Wj24nn9U4VIJnMZrZoe/nw8WbSoV0BNr8qFlqSwAENfYp7hPpBEYlwGh78PnWX15LBKRnA6bqjJrqKZzOMlsqIHXjRzBCOZNxtkFjZVZraZ+2UuDebJBuY6Fga6IttS5Y8LWmHy8mf3FNg7y0T2tLVJ+A4KCam9F3Qo0ft27/bfPpBRD+eh+Ql/ZpbYnqzc2rW7KQCtHwVh7qZu0New+YBQHV0z79LrGQJDxwgTOqAm+8BsZHVSkcq0whLO2A6mmf4W2QasRMrEYoNM6mZqqtQb5fG1RL+wwPCIqCTECaQ62wDXIAbQcAFHTzXtpnDEA5EsKDRmq5eB0eGxeQm/YZBVDBAWnYUavdodh6S2w8QE7aZwxAO91piEexRJsgPwwEL19iuMPkncmNZRxs9QDhYVU7/QUBKkud8uEp9vKrLZ5VV0D6Dr25roqm/ZAVT1w0IL7vmiouS6ksSMWkPT62DWo4ls0VENZ1qKE4ukzaXWPOFWtFWgiglEuDEoWJtMcJ1i8aUElFHWqcQKoT8nb/yjIjijjSRA8Api00HVR9A3RqrQiHSsDNY9KHTTTaoK2/RxwqYDZNQJjUSFKVkDdneeHwWS4galblRUbB1szz8vRqm8+CAJmpLxktMZ7GZe+k269+3oDwHMZ5Z94J6cJW3aJa3z0vC1Du1G3CQUxkHp9hIooBQJz2+fUfYpp++tMgXTguaG05Jmg4QPKz1DSI0z5RTT99AeLaTe5gSQORjmEAoTb7gFTaJ6bppwdAVLupnDzYoERs65GOYWxQEJBK+8Q0/fQEyNz0Wt0gfFsvvRsNkEr7xDT99AQIQh3YesCufstbRatTvnUGYL82SKV9Ypp+egCE9dGCx2+icTZlCzahYQAF3TylfaKafroBvTo7gwED8R2HVJ1oOfnEDDTxFtho+yBM+0Q1/XQDev4I/o6fvGCGALOJTs2tMX08owFidx7R9NMJ6P032P0d3/VcqEntOlovggmfUQHFSycguZjOzh6F2+erwOQFdYdwjiTqujKXzwGfdC8ZENCbT56CFkVPXuC7rqneOVM87oc65qJBKM8fRU9ekICwNEjwfTQwlmhCQZFXf3qAYm2QutkIJHlAkTI/HTY7QLCa3n/7InbyQsmEEr2XFq4Fmh0g2Ac9eBo9eYEBwRHD7jGMOaCeKqBusT52rvKqqbZBbr458upnDaig+a1op/XIKdt5LRoQEeJ7sRgXn1l8Fg3IxOuFnrOgQ0EroJ0qIE+sO/iYQNAKaMc3eObSVr5zuh60sALiCcC4UXTmCDgKtGxARCilw6oqDGIdmgqgprRPsNj16IAkogSKXyz1EdYeaHBA8r+rpkHhtE+46efIgEr2YircgVYoMgbUCyBUaB9QOO0Tbvo5NiBToMh1iYhmPCMdBNSY9ul/ifEN5vWMbYKTTUyDGtM+wwAq1CQT6oKKDrMOZ4Oa0j6DAGJChfAX2JTcfDjtMwwgNVYJy6MRT7adHKBg2mcQQHi7mpIdmBcqm8w+qAqnfYYBhD5e6Mns2dYqepkQoHjpAVDOvarJtl43vnhAnNDQG+jQNmjhgDQfi9AKyPCpAaKD/DYiWbhkQNs9rnjOgDCr6tqgFZARDtjTeR76eywndrzfEifTAkT/l7kGxMFEp65+0RqkAVHaMDfRVrMDWgFR7SauMDyHURf4PtnUuQPCNYbhRK+gY88rni8gyYJvFaHKpqzt4QpI+niJg26AjQFF9wC2AqJgYq7uSZftH2YdDtDVvR+hsyfqboXHBKTDrdSmkUwCkPxYQUCtd8DuC1BJPSwYLNs/xNELINx4TAMQB+zVYEmxAvIBqbuGCmOBJgwIbFDMPZuPCCjFwqBCHzT2jQHN3galhTyJJaqubCIa1OjFBgeUlWnJveAm1roCsgERIXJik7FBkwKEghnV9JBk4cx30lmGA5ItE33gFc8WUKH6fMwpdQVEgh+1yIqEo4mhINDiAeUl3HgWe1dEKAi0AsqxQ8zGMyag48nRAFGPId2c70ZXvABAN7vi+QO64RXPFFCibNA2fDlLA1TrOIQwa5GlYnvjK54FoMDkBRpMeoQrngWg7vvNLxxQy+SFuclhgFomL6waBNIyeWEFBLLaoA5pnrywAiJpm0C1AvJlBdQlTY6+4fv9vvzIsgLqkBVQh6yAOqSvO9TNRlZAHbIC6pAVUIesgDrk5oCcU4cj5jhrf/NjGOxZl9c4UjcgEL2sC4/g7V9uDMiNvtryOnQFECSB4Z6+AMzw27wK8nwe+mYfcmNAbuTDkucPvgt8+zVAaLi6sMb95R+BV/MI3gHkxoDc2Jn7T6ELrqqmlwc16P03/wotMR7BO4DcGJAbfXWkARAEk0Kv/vhB4F1efRq0QTyCd58PeqAMr0HvPgvyqYKaJd89bKRBBrFD/dmgRi/WfFn1KwZndXbWQPQ0ALnRV0dCgJr4NK/UoAbxCN59PuiBMvQ+iFQicMk8U7cujfug8MuPLetOukNWQB2yAuqQFVCHrIA6ZAXUIRMD9PMPY38CX6YFqH4HvdFlBdQhwwO6fkzNotg1er+6uvfF5ja1kN6HvyNa2QeVwQFdP76Dox1pSDGguVOZJ6sG6VX0y0t6grc9009WQNWlnml9uYEBmMzEeTIlGQ3Q2/NbT7TSOE+mJaMtsUuckc5K4zyZloxipOHPJejMXQWIn6CxnpaM5+afSaPz1flDUhp+Ih9jxkUMKdPaKE5QVkAdsgLqkBVQh6yAOmQF1CEroA5ZAXXICqhDVkAd8n9fpGIVb5qedQAAAABJRU5ErkJggg==" alt />
<p class="caption">Scatter map with cut as color scale</p>
</div>
</div>
</div>
<div id="q2the-2nd-example-should-contains-texts-and-at-least-one-table." class="section level2">
<h2>Q2:The 2nd example should contains texts and at least one table.</h2>
</div>
<div id="answer2" class="section level2">
<h2>Answer2:</h2>
<div id="继续使用diamonds数据集并用knitr中的kable函数预览前10条数据并使数据居中" class="section level3">
<h3>继续使用diamonds数据集，并用knitr中的kable函数预览前10条数据，并使数据居中</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">library</span>(knitr)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;knitr&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">kable</span>(diamonds[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,],<span class="dt">caption =</span> <span class="st">&quot;A knitr kable&quot;</span>,<span class="dt">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<caption>A knitr kable</caption>
<thead>
<tr class="header">
<th align="center">carat</th>
<th align="center">cut</th>
<th align="center">color</th>
<th align="center">clarity</th>
<th align="center">depth</th>
<th align="center">table</th>
<th align="center">price</th>
<th align="center">x</th>
<th align="center">y</th>
<th align="center">z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.23</td>
<td align="center">Ideal</td>
<td align="center">E</td>
<td align="center">SI2</td>
<td align="center">61.5</td>
<td align="center">55</td>
<td align="center">326</td>
<td align="center">3.95</td>
<td align="center">3.98</td>
<td align="center">2.43</td>
</tr>
<tr class="even">
<td align="center">0.21</td>
<td align="center">Premium</td>
<td align="center">E</td>
<td align="center">SI1</td>
<td align="center">59.8</td>
<td align="center">61</td>
<td align="center">326</td>
<td align="center">3.89</td>
<td align="center">3.84</td>
<td align="center">2.31</td>
</tr>
<tr class="odd">
<td align="center">0.23</td>
<td align="center">Good</td>
<td align="center">E</td>
<td align="center">VS1</td>
<td align="center">56.9</td>
<td align="center">65</td>
<td align="center">327</td>
<td align="center">4.05</td>
<td align="center">4.07</td>
<td align="center">2.31</td>
</tr>
<tr class="even">
<td align="center">0.29</td>
<td align="center">Premium</td>
<td align="center">I</td>
<td align="center">VS2</td>
<td align="center">62.4</td>
<td align="center">58</td>
<td align="center">334</td>
<td align="center">4.20</td>
<td align="center">4.23</td>
<td align="center">2.63</td>
</tr>
<tr class="odd">
<td align="center">0.31</td>
<td align="center">Good</td>
<td align="center">J</td>
<td align="center">SI2</td>
<td align="center">63.3</td>
<td align="center">58</td>
<td align="center">335</td>
<td align="center">4.34</td>
<td align="center">4.35</td>
<td align="center">2.75</td>
</tr>
<tr class="even">
<td align="center">0.24</td>
<td align="center">Very Good</td>
<td align="center">J</td>
<td align="center">VVS2</td>
<td align="center">62.8</td>
<td align="center">57</td>
<td align="center">336</td>
<td align="center">3.94</td>
<td align="center">3.96</td>
<td align="center">2.48</td>
</tr>
<tr class="odd">
<td align="center">0.24</td>
<td align="center">Very Good</td>
<td align="center">I</td>
<td align="center">VVS1</td>
<td align="center">62.3</td>
<td align="center">57</td>
<td align="center">336</td>
<td align="center">3.95</td>
<td align="center">3.98</td>
<td align="center">2.47</td>
</tr>
<tr class="even">
<td align="center">0.26</td>
<td align="center">Very Good</td>
<td align="center">H</td>
<td align="center">SI1</td>
<td align="center">61.9</td>
<td align="center">55</td>
<td align="center">337</td>
<td align="center">4.07</td>
<td align="center">4.11</td>
<td align="center">2.53</td>
</tr>
<tr class="odd">
<td align="center">0.22</td>
<td align="center">Fair</td>
<td align="center">E</td>
<td align="center">VS2</td>
<td align="center">65.1</td>
<td align="center">61</td>
<td align="center">337</td>
<td align="center">3.87</td>
<td align="center">3.78</td>
<td align="center">2.49</td>
</tr>
<tr class="even">
<td align="center">0.23</td>
<td align="center">Very Good</td>
<td align="center">H</td>
<td align="center">VS1</td>
<td align="center">59.4</td>
<td align="center">61</td>
<td align="center">338</td>
<td align="center">4.00</td>
<td align="center">4.05</td>
<td align="center">2.39</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="q3the-3rd-example-should-contain-at-least-a-couple-of-latex-formulas." class="section level2">
<h2>Q3:The 3rd example should contain at least a couple of LaTeX formulas.</h2>
</div>
<div id="answer3" class="section level2">
<h2>Answer3:</h2>
<div id="第一个公式" class="section level3">
<h3>第一个公式</h3>
<p><span class="math display">\[f(x)=ax^3+bx^2+cx+d\]</span></p>
</div>
<div id="第二个公式" class="section level3">
<h3>第二个公式</h3>
<p><span class="math display">\[J(\theta) = \frac{1}{2m}\sum_{i = 0} ^m(y^i - h_\theta (x^i))^2\]</span></p>
</div>
<div id="第三个公式" class="section level3">
<h3>第三个公式</h3>
<p><span class="math display">\[H(X)=\sum_{x\in X,y\in Y}{P}(x,y)log{\dfrac{p(x)}{p(x,y)}}\]</span></p>
</div>
</div>
</div>
<div id="a-20066-2020-09-22-1" class="section level1">
<h1>A-20066-2020-09-22</h1>
</div>
<div id="hw1-exercises-3.3-3.9-3.10-3.13" class="section level1">
<h1>HW1 Exercises 3.3 3.9 3.10 3.13</h1>
<div id="解答" class="section level2">
<h2>3.3.解答</h2>
<div id="derive-the-probability-inverse-transformation-and-use-the-inverse-transform-method-to-simulate-a-random-sample-from-the-pareto22-distribution." class="section level4">
<h4>1.Derive the probability inverse transformation and use the inverse transform method to simulate a random sample from the Pareto(2,2) distribution.</h4>
</div>
<div id="pareto22的分布函数为fx1-frac2x2则fmathopnolimits-1x2e-fracln1-x2" class="section level4">
<h4>Pareto(2,2)的分布函数为<span class="math display">\[F(x)=1-(\frac{2}{x})^2\]</span>则<span class="math display">\[F\mathop{{}}\nolimits^{{-1}}(x)=2e^{-\frac{ln(1-x)}{2}}\]</span></h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">set.seed</span>(<span class="dv">16273</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>n &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)   <span class="co">#产生100个服从均匀分布的随机数</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>((<span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)))<span class="op">/</span><span class="dv">2</span>) <span class="co"># F(x) = 1-(2/x)^2,x&gt;=2,生成服从Pareto(2,2)的随机数x</span></span></code></pre></div>
</div>
<div id="graph-the-density-histogram-of-the-sample-with-the-pareto22-density-superimposed-for-comparison." class="section level4">
<h4>2.Graph the density histogram of the sample with the Pareto(2,2) density superimposed for comparison.</h4>
</div>
<div id="pareto22的密度函数为fxfrac8x3-xgeqslant2" class="section level4">
<h4>Pareto(2,2)的密度函数为<span class="math display">\[f(x)=\frac{8}{x^3}  ,x\geqslant2\]</span></h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">breaks =</span> <span class="dv">10</span>)  <span class="co">#绘制x的频率分布直方图</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">20</span>, <span class="fl">.01</span>)    <span class="co">#绘制Pareto(2,2)的概率密度函数</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">/</span>y<span class="op">^</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="解答-1" class="section level2">
<h2>3.9.解答</h2>
<div id="write-a-function-based-on-the-algorithm-to-generate-random-variates-from-f_e-and-construct-the-histogram-density-estimate-of-a-large-simulated-random-sample." class="section level4">
<h4>1.Write a function based on the algorithm to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">set.seed</span>(<span class="dv">26667</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>n &lt;-<span class="dv">1000</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a>u3 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb12-7"><a href="#cb12-7"></a>    <span class="cf">if</span> ((<span class="kw">abs</span>(u3[i]) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(u2[i]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(u3[i]) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(u1[i]))){</span>
<span id="cb12-8"><a href="#cb12-8"></a>      x[i] &lt;-<span class="st"> </span>u2[i]</span>
<span id="cb12-9"><a href="#cb12-9"></a>    }<span class="cf">else</span>{</span>
<span id="cb12-10"><a href="#cb12-10"></a>      x[i] &lt;-<span class="st"> </span>u3[i]</span>
<span id="cb12-11"><a href="#cb12-11"></a>    }</span>
<span id="cb12-12"><a href="#cb12-12"></a>}                 <span class="co">#根据题中所给算法从目标分布中产生随机数</span></span>
<span id="cb12-13"><a href="#cb12-13"></a></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">breaks =</span> <span class="dv">10</span>)      <span class="co">#构建频率分布直方图</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="解答-2" class="section level2">
<h2>3.10.解答</h2>
<div id="prove-that-the-algorithm-given-in-exercise-3.9-generates-variates-from-the-density-f_e" class="section level4">
<h4>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span></h4>
</div>
<div id="记题中算法为" class="section level4">
<h4>记题中算法为</h4>
<p><span class="math display">\[ X=\left\{
\begin{array}{rcl}
u_2 &amp; &amp;  {|u_3|\ge |u_2|\quad |u_3|\ge |u_1|} \\
u_3 &amp; &amp; {else}
\end{array}
\right.\]</span></p>
</div>
<div id="其分布函数为fx" class="section level4">
<h4>其分布函数为<span class="math inline">\(F(x)\)</span></h4>
<p><span class="math display">\[\begin{aligned}
F(x)&amp;=P(X\le x)\\&amp; =P(u_2\le x,|u_3|\ge |u_2|,|u_3|\ge |u_1|)+P(u_3\le x,|u_3|\le |u_2|, |u_3|\ge |u_1|)\hfill \\&amp;+P(u_3\le x,|u_3|\le |u_2|, |u_3|\le |u_1|)+P(u_3\le x,|u_3|\ge |u_2|, |u_3|\le |u_1|)
\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}
&amp;P(u_2\le x,|u_3|\ge |u_2|,|u_3|\ge |u_1|)\\ 
&amp;= \int_{-1}^x f(u_2)du_2\int_{|u_3|\ge |u_2|} f(u_3)du_3\int_{|u_3|\ge|u_1|}f(u_1)du_1\\&amp;=\int_{-1}^x f(u_2)du_2\int_{|u_3|\ge |u_2|} |u_3|f(u_3)du_3\\&amp;=\int_{-1}^x \frac{1}{4}(1-u_2^2)du_2\\&amp;=\frac{1}{4}(x-\frac{1}{3}x^3+\frac{2}{3})
\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}
&amp;P(u_3\le x,|u_3|\le |u_2|, |u_3|\ge |u_1|)+P(u_3\le x,|u_3|\le |u_2|, |u_3|\le |u_1|)\\
&amp;= \int_{-1}^x f(u_3)du_3\int_{|u_3|\le |u_2|} f(u_2)du_2\int_{|u_3|\le|u_1|}f(u_1)du_1+\int_{-1}^x f(u_3)du_3\int_{|u_3|\le |u_2|} f(u_2)du_2\int_{|u_3|\ge|u_1|}f(u_1)du_1\\&amp;=\int_{-1}^x f(u_3)du_3\int_{|u_3|\le |u_2|} f(u_2)du_2\\&amp;=
\int_{-1}^x \frac{1}{2}(1-|u_3|)du_3
\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}
&amp;P(u_3\le x,|u_3|\ge |u_2|, |u_3|\le |u_1|)\\
&amp;=\int_{-1}^x f(u_3)du_3\int_{|u_3|\ge |u_2|} f(u_2)du_2\int_{|u_3|\le|u_1|}f(u_1)du_1\\&amp;=\int_{-1}^x f(u_3)du_3\int_{|u_3|\ge |u_2|} f(u_2)(1-|u_3|)du_2\\&amp;=\int_{-1}^x \frac{1}{2}|u_3|(1-|u_3|)du_3
\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}
&amp;P(u_3\le x,|u_3|\le |u_2|, |u_3|\ge |u_1|)+P(u_3\le x,|u_3|\le |u_2|, |u_3|\le |u_1|)+P(u_3\le x,|u_3|\ge |u_2|, |u_3|\le |u_1|)\\
&amp;=\int_{-1}^x \frac{1}{2}(1-|u_3|)du_3+\int_{-1}^x \frac{1}{2}|u_3|(1-|u_3|)du_3\\&amp;=\int_{-1}^x \frac{1}{2}(1-u_3^2)du_3\\&amp;=\frac{1}{2}(x-\frac{1}{3}x^3+\frac{2}{3})
\end{aligned}\]</span></p>
</div>
<div id="带入求得fx为" class="section level4">
<h4>带入求得<span class="math inline">\(F(x)\)</span>为</h4>
<p><span class="math display">\[\begin{aligned}
F(x)&amp;=P(X\le x)\\ &amp;=P(u_2\le x,|u_3|\ge |u_2|,|u_3|\ge |u_1|)+P(u_3\le x,|u_3|\le |u_2|, |u_3|\ge |u_1|)\\ &amp;+P(u_3\le x,|u_3|\le |u_2|, |u_3|\le |u_1|)+P(u_3\le x,|u_3|\ge |u_2|, |u_3|\le |u_1|)\\ &amp;=\frac{3}{4}(x-\frac{1}{3}x^3+\frac{2}{3})
\end{aligned}\]</span></p>
</div>
<div id="x的密度函数为fx由此可知按此算法所产生的随机数来自于f_e" class="section level4">
<h4>X的密度函数为<span class="math inline">\(f(x)\)</span>，由此可知按此算法所产生的随机数来自于<span class="math inline">\(f_e\)</span></h4>
<p><span class="math display">\[f(x)=F&#39;(x)=(P(X\le x))&#39;=\frac{3}{4}(1-x^2)\]</span></p>
</div>
</div>
</div>
<div id="a-20066-2020-10-13" class="section level1">
<h1>A-20066-2020-10-13</h1>
</div>
<div id="hw2-5.1-5.7-5.11" class="section level1">
<h1>HW2 (5.1 5.7 5.11)</h1>
<div id="question-5.1" class="section level2">
<h2>Question 5.1</h2>
<div id="compute-a-monte-carlo-estimate-of-int_0fracpi3sintrm-dt-and-compare-your-estimate-with-the-exact-value-of-the-integral." class="section level4">
<h4>Compute a Monte Carlo estimate of <span class="math inline">\(\int_{0}^{\frac{\pi}{3}}sint\,{\rm d}t\)</span> and compare your estimate with the exact value of the integral.</h4>
</div>
</div>
<div id="answer-5.1" class="section level2">
<h2>Answer 5.1</h2>
<div id="经计算int_0fracpi3sintrm-dtfrac12" class="section level4">
<h4>经计算<span class="math inline">\(\int_{0}^{\frac{\pi}{3}}sint\,{\rm d}t=\frac{1}{2}\)</span></h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">set.seed</span>(<span class="dv">14256</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e5</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)   <span class="co">#生成模拟的随机数</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>I &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)) <span class="op">*</span><span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span>   <span class="co">#根据蒙特卡洛方法计算积分值</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="kw">print</span>(<span class="kw">c</span>(I,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,I<span class="op">*</span><span class="dv">2</span>))   <span class="co">#打印估计值，理论值，以及他们的比值（越接近1模拟地越准确）</span></span></code></pre></div>
<pre><code>## [1] 0.5004412 0.5000000 1.0008824</code></pre>
</div>
</div>
<div id="question-5.7" class="section level2">
<h2>Question 5.7</h2>
<div id="use-a-monte-carlo-simulation-to-estimate-hatthetaint_01etrm-dt-by-the-antithetic-variate-approach-and-by-the-simple-monte-carlo-method.-compute-an-empirical-estimate-of-the-percent-reduction-in-variance-using-the-antithetic-variate.compare-the-result-with-the-theoretical-value-from-exercise-5.6." class="section level4">
<h4>Use a Monte Carlo simulation to estimate <span class="math inline">\(\hat{\theta}=\int_{0}^{1}e^t\,{\rm d}t\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate.Compare the result with the theoretical value from Exercise 5.6.</h4>
</div>
</div>
<div id="answer-5.7" class="section level2">
<h2>Answer 5.7</h2>
<div id="先用两种方法估计theta并比较使用对偶方法方差减少的百分比" class="section level4">
<h4>先用两种方法估计<span class="math inline">\(\theta\)</span>,并比较使用对偶方法方差减少的百分比</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>MC.Phi &lt;-<span class="st"> </span><span class="cf">function</span>(x, R, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</span>
<span id="cb15-2"><a href="#cb15-2"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,x)</span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</span>
<span id="cb15-4"><a href="#cb15-4"></a>  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)   <span class="co">#生成随机数</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  g &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(u )</span>
<span id="cb15-6"><a href="#cb15-6"></a>  cdf&lt;-<span class="st"> </span><span class="kw">mean</span>(g) </span>
<span id="cb15-7"><a href="#cb15-7"></a>}      <span class="co">#计算e^x在[0,x]上的积分值</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb15-11"><a href="#cb15-11"></a>x &lt;-<span class="st"> </span><span class="dv">1</span>   <span class="co">#计算e^x在[0,1]上的积分值</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb15-13"><a href="#cb15-13"></a>  MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)  <span class="co">#the simple Monte Carlo method</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>  MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dv">1000</span>)   <span class="co">#the antithetic variate approach</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>}</span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="kw">format</span>(<span class="kw">c</span>(<span class="kw">var</span>(MC1),<span class="kw">var</span>(MC2),<span class="dv">1</span><span class="op">-</span><span class="kw">var</span>(MC2)<span class="op">/</span><span class="kw">var</span>(MC1)),<span class="dt">scientific =</span> <span class="ot">FALSE</span>)   <span class="co">#输出模拟的简单蒙特卡洛方差，对偶方法的方差，以及使用对偶方法方差减少的百分比</span></span></code></pre></div>
<pre><code>## [1] &quot;0.000241014795&quot; &quot;0.000008307119&quot; &quot;0.965532742707&quot;</code></pre>
</div>
<div id="计算两种模拟方法的理论方差减小的百分比记用简单蒙特卡洛方法估计值-hattheta_1-frac1msum_j1m-eu_j记用对偶方法的估计值hattheta_2-frac1msum_j1fracm2-eu_je1-u_j其中u_ji.i.dsim-u01分别求得他们的理论方差为" class="section level4">
<h4>计算两种模拟方法的理论方差减小的百分比，记用简单蒙特卡洛方法估计值 <span class="math inline">\(\hat{\theta_1} =\frac{1}{m}\sum_{j=1}^m e^{u_j}\)</span>,记用对偶方法的估计值<span class="math inline">\(\hat{\theta_2} =\frac{1}{m}\sum_{j=1}^{\frac{m}{2}} (e^{u_j}+e^{1-u_j})\)</span>,其中<span class="math inline">\({u_j}{i.i.d}{\sim} U(0,1)\)</span>,分别求得他们的理论方差为</h4>
<p><span class="math display">\[
\begin{align}
Var(\hat{\theta_1})
&amp; = \frac{1}{m}Var(e^{u_j}) \\
&amp; = \frac{1}{m}\Big(E(e^{2u_j})-\big(E(e^{u_j})\big)^2\Big) \\
&amp; = \frac{1}{m}\big(\int_{0}^{1}e^{2u_j}\, {\rm d}u_j-(\int_{0}^{1}e^{u_j}\, {\rm d}u_j)^2 \big) \\
&amp; = \frac{1}{m}\big(\frac{1}{2}(e^2-1)-(e-1)^2 \big)
\end{align}
\]</span></p>
<p>同理可算 <span class="math display">\[
\begin{align}
Var(\hat{\theta_2})
&amp; = \frac{1}{2m}Var(e^{u_j}+e^{1-u_j}) \\
&amp; = \frac{1}{2m}\Big(Var(e^{u_j})+Var(e^{1-u_j})+2Cov(e^{u_j},e^{1-u_j}) \Big) \\
&amp; = \frac{1}{2m}\big(2Var(e^{u_j})+2(e-E(e^{u_j})E(e^{1-u_j})) \big) \\
&amp; = \frac{1}{2m}\big((e^2-1)+2e-4(e-1)^2 \big) 
\end{align}
\]</span></p>
<p>带入自然常数e,计算使用对偶方法方差减少的百分比为<span class="math inline">\(1-\frac{Var{\hat{\theta_2}}}{Var{\hat{\theta_1}}}\approx0.96767=96.767\%\)</span></p>
</div>
</div>
<div id="question-5.11" class="section level2">
<h2>Question 5.11</h2>
<div id="that-is-if-hattheta_1-and-hattheta_2-are-any-two-unbiased-estimators-of-theta-find-the-value-c-that-minimizes-the-variance-of-the-estimator-hattheta_c-chattheta_1-1-chattheta_2in-equation-5.11." class="section level4">
<h4>That is, if <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta_c}= c\hat{\theta_1} + (1-c)\hat{\theta_2}\)</span>in equation (5.11).</h4>
</div>
</div>
<div id="answer-5.11" class="section level2">
<h2>Answer 5.11</h2>
<div id="计算-varhattheta_c" class="section level4">
<h4>计算 <span class="math inline">\(Var(\hat{\theta_c})\)</span></h4>
<p><span class="math display">\[
\begin{align}
Var(\hat{\theta_c})
&amp; = Var(c\hat{\theta_1}+(1-c)\hat{\theta_2}) \\
&amp; = c^2Var(\hat{\theta_1})+(1-c)^2Var(\hat{\theta_2})+2c(1-c)Cov(\hat{\theta_1},\hat{\theta_2}) \\
&amp; = c^2Var(\hat{\theta_1})+(1+c^2-2c)Var(\hat{\theta_2})+(2c-2c^2)Cov(\hat{\theta_1},\hat{\theta_2}) \\
&amp; = \big( Var(\hat{\theta_1})+Var(\hat{\theta_2})-2Cov(\hat{\theta_1},\hat{\theta_2}) \big)c^2+\big( 2Cov(\hat{\theta_1},\hat{\theta_2})-2Var(\hat\theta_2) \big)c+Var(\hat{\theta_2})
\end{align}
\]</span></p>
</div>
<div id="此时这是一个开口向上的一元二次函数在c取最小值" class="section level4">
<h4>此时这是一个开口向上的一元二次函数，在<span class="math inline">\(c^*\)</span>取最小值</h4>
<p><span class="math display">\[c^*=\frac{Var(\hat{\theta_2})-Cov(\hat{\theta_1},\hat{\theta_2})}{Var(\hat{\theta_1})+Var(\hat{\theta_2})-2Cov(\hat{\theta_1},\hat{\theta_2})}\]</span></p>
</div>
</div>
</div>
<div id="a-20066-2020-10-20" class="section level1">
<h1>A-20066-2020-10-20</h1>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
</div>
<div id="question5.13" class="section level1">
<h1>Question5.13</h1>
<div id="find-two-importance-functions-f_1-and-f_2-that-are-supported-on-1infty-and-are-close-to-gxfracx2sqrt2pie-fracx22-x-1-which-of-your-two-importance-functions-should-produce-the-smaller-variance-in-estimating-int_1inftyfracx2sqrt2pie-fracx22-rm-dx-by-importance-sampling-explain." class="section level4">
<h4>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}, \  x &gt;1\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} {\rm  d}x\]</span> by importance sampling? Explain.</h4>
</div>
</div>
<div id="answer5.13" class="section level1">
<h1>Answer5.13</h1>
<div id="i-use-two-importance-function" class="section level4">
<h4>I use two importance function</h4>
<p><span class="math display">\[f_1(x) =
\begin{cases} 
x^{-2},  &amp; x\in(1,\infty) \\
0,&amp;otherwise
\end{cases}
\]</span> <span class="math display">\[
f_2(x) =
\begin{cases} 
\frac{x}{\sqrt{e}}e^{-\frac{x^2}{2}},  &amp; x\in(1,\infty) \\
0,&amp;otherwise
\end{cases}\]</span></p>
</div>
<div id="theyre-pdf-supported-on-1inftyi-plot-the-curve-of-gxf_1x-and-f_2x-they-all-close-to-gx." class="section level4">
<h4>they’re pdf supported on <span class="math inline">\((1,\infty)\)</span>,I plot the curve of <span class="math inline">\(g(x)\)</span>,<span class="math inline">\(f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span> ,they all “close” to <span class="math inline">\(g(x)\)</span>.</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">1000</span>,<span class="fl">0.1</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>y &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="kw">plot</span>(x,y,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;DarkTurquoise&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="kw">lines</span>(x<span class="op">^</span>(<span class="op">-</span><span class="dv">2</span>),<span class="dt">col=</span><span class="st">&quot;DeepPink&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="kw">lines</span>(x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2-1</span>)<span class="op">/</span><span class="dv">2</span>),<span class="dt">col=</span><span class="st">&quot;RosyBrown&quot;</span>,<span class="dt">lty=</span><span class="dv">3</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="kw">legend</span>(<span class="dv">700</span>,<span class="fl">0.25</span>,<span class="kw">c</span>(<span class="st">&quot;g(x)&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;DarkTurquoise&quot;</span>,<span class="st">&quot;DeepPink&quot;</span>,<span class="st">&quot;RosyBrown&quot;</span>),<span class="dt">text.col=</span><span class="kw">c</span>(<span class="st">&quot;DarkTurquoise&quot;</span>,<span class="st">&quot;DeepPink&quot;</span>,<span class="st">&quot;RosyBrown&quot;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="throught-pdf-of-f_1-and-f_2-to-compute-their-cdfthen-use-inverse-transform-method-to-generate-random-numberby-importance-sampling-to-estimate-the-value-of-int_1inftyfracx2sqrt2pie-fracx22-rm-dx." class="section level4">
<h4>Throught pdf of <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> to compute their cdf,then use inverse transform method to generate random number,by importance sampling to estimate the value of <span class="math inline">\(\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} {\rm d}x\)</span>.</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>theta_<span class="dv">1</span> &lt;-<span class="st"> </span>theta_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {</span>
<span id="cb18-5"><a href="#cb18-5"></a>  x0&lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb18-6"><a href="#cb18-6"></a>  x1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x0)  <span class="co">#用逆变换法求服从密度函数为f1的随机数x1</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>  x2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1-2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>x0))  <span class="co">#用逆变换法求服从密度函数为f2的随机数x2</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>  theta_<span class="dv">1</span>[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((x1)<span class="op">^</span><span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>((<span class="op">-</span>(x1)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb18-9"><a href="#cb18-9"></a>  theta_<span class="dv">2</span>[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((x2)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))  <span class="co">#分别用f1,f2估计积分值theta</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>}</span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="kw">print</span>(<span class="kw">format</span>(<span class="kw">c</span>(<span class="kw">var</span>(theta_<span class="dv">1</span>),<span class="kw">var</span>(theta_<span class="dv">2</span>),<span class="kw">var</span>(theta_<span class="dv">1</span>)<span class="op">/</span><span class="kw">var</span>(theta_<span class="dv">2</span>))))</span></code></pre></div>
<pre><code>## [1] &quot;8.840592e-05&quot; &quot;1.587705e-05&quot; &quot;5.568159e+00&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">mean</span>(theta_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.3995229</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">mean</span>(theta_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.4007228</code></pre>
</div>
<div id="from-the-results-abovef_2importance-functions-produce-the-smaller-variancebecause-the-curve-of-f_2x-is-closer-to-gx-than-f_1x." class="section level4">
<h4>From the results above,<span class="math inline">\(f_2\)</span>importance functions produce the smaller variance,because the curve of <span class="math inline">\(f_2(x)\)</span> is closer to <span class="math inline">\(g(x)\)</span> than <span class="math inline">\(f_1(x)\)</span>.</h4>
</div>
</div>
<div id="question5.15" class="section level1">
<h1>Question5.15</h1>
<div id="obtain-the-stratified-importance-sampling-estimate-in-example-5.13-and-compare-it-with-the-result-of-example-5.10." class="section level4">
<h4>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</h4>
</div>
</div>
<div id="answer5.15" class="section level1">
<h1>Answer5.15</h1>
<div id="in-example-5.13-the-aim-is-to-estimate-hatthetaint_01frace-x1x2-rm-dx." class="section level4">
<h4>In Example 5.13 ,the aim is to estimate <span class="math inline">\(\hat{\theta}=\int_{0}^{1}\frac{e^{-x}}{1+x^2} {\rm d}x\)</span>.</h4>
</div>
<div id="now-divide-the-interval-01-into-five-subintervals-j5-j-15-j-0-1-.-.-.-4.then-on-the-jth-subinterval-variables-are-generated-from-the-densityfrac5e-x1-e-1fracj-15xfracj5" class="section level4">
<h4>Now divide the interval (0,1) into five subintervals, (j/5, (j + 1)/5), j = 0, 1, . . . , 4.Then on the <span class="math inline">\(j^{th}\)</span> subinterval variables are generated from the density<span class="math display">\[\frac{5e^{-x}}{1-e^{-1}},\frac{j-1}{5}&lt;x&lt;\frac{j}{5}\]</span></h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>M &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>k &lt;-<span class="st"> </span><span class="dv">5</span> </span>
<span id="cb24-3"><a href="#cb24-3"></a>r &lt;-<span class="st"> </span>M<span class="op">/</span>k <span class="co">#replicates per stratum</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>T &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb24-6"><a href="#cb24-6"></a>est &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb24-7"><a href="#cb24-7"></a>g&lt;-<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb24-8"><a href="#cb24-8"></a>f3&lt;-<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb24-10"><a href="#cb24-10"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb24-11"><a href="#cb24-11"></a>    x0 &lt;-<span class="st"> </span><span class="kw">runif</span>(M<span class="op">/</span>k,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb24-12"><a href="#cb24-12"></a>    x1 &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>x0<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb24-13"><a href="#cb24-13"></a>    T[j]&lt;-<span class="kw">mean</span>(<span class="kw">g</span>(x1)<span class="op">/</span><span class="kw">f3</span>(x1)<span class="op">*</span>(x1<span class="op">&gt;</span>(j<span class="dv">-1</span>)<span class="op">/</span>k)<span class="op">*</span>(x1<span class="op">&lt;</span>j<span class="op">/</span>k))</span>
<span id="cb24-14"><a href="#cb24-14"></a>    }</span>
<span id="cb24-15"><a href="#cb24-15"></a>  est[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(T)   </span>
<span id="cb24-16"><a href="#cb24-16"></a>}</span>
<span id="cb24-17"><a href="#cb24-17"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(est),<span class="kw">sd</span>(est)))</span></code></pre></div>
<pre><code>## [1] 0.524369989 0.009891016</code></pre>
</div>
<div id="from-the-results-of-the-stratified-importance-sampling-estimate.in-example-5.10-our-best-result-was-obtained-with-importance-function-f_3x-frace-x1-e-10-x-1.-from-10000-replicates-we-obtained-the-estimate-hattheta-0.5257801-and-an-estimated-standard-error-0.0970314.we-know-the-stratified-importance-sampling-estimate-is-better-than-the-importance-sampling-estimate." class="section level4">
<h4>From the results of the stratified importance sampling estimate.In Example 5.10 our best result was obtained with importance function <span class="math inline">\(f_3(x) =\frac{e^{-x}}{1-e^{-1}},0 &lt; x &lt; 1\)</span>. From 10000 replicates we obtained the estimate <span class="math inline">\(\hat{\theta}\)</span> = 0.5257801 and an estimated standard error 0.0970314.We know the stratified importance sampling estimate is better than the importance sampling estimate.</h4>
</div>
</div>
<div id="question6.4" class="section level1">
<h1>Question6.4</h1>
<div id="suppose-that-x1-.-.-.-xn-are-a-random-sample-from-a-from-a-lognormal-distribution-with-unknown-parameters.-construct-a-95-confidence-interval-for-the-parameter-μ.-use-a-monte-carlo-method-to-obtain-an-empirical-estimate-of-the-confidence-level." class="section level4">
<h4>Suppose that X1, . . . , Xn are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter μ. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</h4>
</div>
</div>
<div id="answer6.4" class="section level1">
<h1>Answer6.4</h1>
<div id="x_1x_2...x_ni.d.dsimln04let-ylnxso-y_1y_2...y_ni.d.dsimn04alpha0.05let-tfracbary-mussqrtn-and-tsimtn-1." class="section level4">
<h4><span class="math inline">\(X_1,X_2,...,X_n{i.d.d}{\sim}LN(0,4)\)</span>,let <span class="math inline">\(Y=ln(X)\)</span>,so <span class="math inline">\(y_1,y_2,...,y_n{i.d.d}{\sim}N(0,4)\)</span>,<span class="math inline">\(\alpha=0.05\)</span>,let <span class="math display">\[t=\frac{\bar{y}-\mu}{s/\sqrt{n}} \]</span>,and <span class="math inline">\(t{\sim}t(n-1)\)</span>.</h4>
</div>
<div id="nowconstruct-a-95-confidence-interval-for-the-parameter-μmuinbary-t_0.975n-1fracssqrtnbaryt_0.975n-1fracssqrtn" class="section level4">
<h4>Now,construct a 95% confidence interval for the parameter μ,<span class="math display">\[\mu\in(\bar{y}-t_{0.975}(n-1)\frac{s}{\sqrt{n}},\bar{y}+t_{0.975}(n-1)\frac{s}{\sqrt{n}})\]</span></h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>count&lt;-<span class="dv">0</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>lcl&lt;-ucl&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb26-8"><a href="#cb26-8"></a>    x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n, <span class="dt">meanlog =</span> <span class="dv">0</span>, <span class="dt">sdlog =</span> <span class="dv">2</span>)</span>
<span id="cb26-9"><a href="#cb26-9"></a>    y &lt;-<span class="st"> </span><span class="kw">log</span>(x)</span>
<span id="cb26-10"><a href="#cb26-10"></a>  }</span>
<span id="cb26-11"><a href="#cb26-11"></a>  lcl[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(y)<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(y)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb26-12"><a href="#cb26-12"></a>  ucl[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(y)<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(y)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb26-13"><a href="#cb26-13"></a>  <span class="cf">if</span> (lcl[i]<span class="op">&lt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>ucl[i]<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb26-14"><a href="#cb26-14"></a>     {count&lt;-count<span class="op">+</span><span class="dv">1</span>}</span>
<span id="cb26-15"><a href="#cb26-15"></a>  <span class="cf">else</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>     {count&lt;-count}</span>
<span id="cb26-17"><a href="#cb26-17"></a>}</span>
<span id="cb26-18"><a href="#cb26-18"></a>conf_level&lt;-count<span class="op">/</span>m</span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="kw">print</span>(<span class="kw">c</span>(conf_level))</span></code></pre></div>
<pre><code>## [1] 0.9511</code></pre>
</div>
<div id="from-the-resultwe-can-see-the-monte-carlo-method-to-obtain-an-empirical-estimate-of-the-confidence-level-is-very-close-to-the-true-confidence-levelalpha." class="section level4">
<h4>From the result,we can see the Monte Carlo method to obtain an empirical estimate of the confidence level is very close to the true confidence level<span class="math inline">\(\alpha\)</span>.</h4>
</div>
</div>
<div id="qestion6.5" class="section level1">
<h1>Qestion6.5</h1>
<div id="use-a-monte-carlo-experiment-to-estimate-the-coverage-probability-of-the-t-interval-for-random-samples-of-chi22-data-with-sample-size-n-20.-compare-your-t-interval-results-with-the-simulation-results-in-example-6.4." class="section level4">
<h4>Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4.</h4>
</div>
</div>
<div id="answer6.5" class="section level1">
<h1>Answer6.5</h1>
<div id="firstgenerate-random-samples-of-chi22-data-with-sample-size-n-20then-use-t-distribution-to-estimate-its-meanand-the-true-mean-of-chi22is-its-dfdegree-of-freedomat-lastcompute-the-coverage-probability-of-the-t-interval." class="section level4">
<h4>First,generate random samples of <span class="math inline">\(\chi{2}(2)\)</span> data with sample size n = 20,then use t distribution to estimate it’s mean,and the true mean of <span class="math inline">\(\chi{2}(2)\)</span>is it’s df(degree of freedom),at last,compute the coverage probability of the t-interval.</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>count&lt;-<span class="dv">0</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>df&lt;-<span class="dv">2</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>lcl&lt;-ucl&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb28-8"><a href="#cb28-8"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb28-9"><a href="#cb28-9"></a>    x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, df)</span>
<span id="cb28-10"><a href="#cb28-10"></a>  }</span>
<span id="cb28-11"><a href="#cb28-11"></a>  lcl[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(y)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb28-12"><a href="#cb28-12"></a>  ucl[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(y)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb28-13"><a href="#cb28-13"></a>  <span class="cf">if</span> (lcl[i]<span class="op">&lt;</span>df <span class="op">&amp;</span><span class="st"> </span>ucl[i]<span class="op">&gt;</span>df)</span>
<span id="cb28-14"><a href="#cb28-14"></a>     {count&lt;-count<span class="op">+</span><span class="dv">1</span>}</span>
<span id="cb28-15"><a href="#cb28-15"></a>  <span class="cf">else</span></span>
<span id="cb28-16"><a href="#cb28-16"></a>     {count&lt;-count}</span>
<span id="cb28-17"><a href="#cb28-17"></a>}</span>
<span id="cb28-18"><a href="#cb28-18"></a>conf_level&lt;-count<span class="op">/</span>m</span>
<span id="cb28-19"><a href="#cb28-19"></a><span class="kw">print</span>(conf_level)</span></code></pre></div>
<pre><code>## [1] 0.9742</code></pre>
</div>
<div id="compare-the-conf_level-with-1-alphawe-can-see-the-error-is-a-little-largeso-the-probability-that-the-confidence-interval-covers-the-mean-is-not-necessarily-equal-to-0.95." class="section level4">
<h4>Compare the conf_level with <span class="math inline">\(1-\alpha\)</span>,we can see the error is a little large,so the probability that the confidence interval covers the mean is not necessarily equal to 0.95.</h4>
</div>
</div>
<div id="a-20066-2020-10-27" class="section level1">
<h1>A-20066-2020-10-27</h1>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
</div>
<div id="question6.7" class="section level1">
<h1>Question6.7</h1>
<div id="estimate-the-power-of-the-skewness-test-of-normality-against-symmetric-betaalpha-alpha-distributions-and-comment-on-the-results.-are-the-results-different-for-heavy-tailed-symmetric-alternatives-such-as-tν" class="section level4">
<h4>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(ν)\)</span>?</h4>
</div>
</div>
<div id="answer6.7" class="section level1">
<h1>Answer6.7</h1>
<div id="estimate-the-power-of-the-skewness-test-of-normality-against-symmetric-betaalpha-alpha-distributions" class="section level4">
<h4>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span> distributions</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb30-2"><a href="#cb30-2"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb30-3"><a href="#cb30-3"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb30-6"><a href="#cb30-6"></a>}</span>
<span id="cb30-7"><a href="#cb30-7"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>beta_alpha &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">5</span>)</span>
<span id="cb30-11"><a href="#cb30-11"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(beta_alpha)</span>
<span id="cb30-12"><a href="#cb30-12"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb30-13"><a href="#cb30-13"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb30-14"><a href="#cb30-14"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb30-15"><a href="#cb30-15"></a>  b &lt;-<span class="st"> </span>beta_alpha[j]</span>
<span id="cb30-16"><a href="#cb30-16"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb30-17"><a href="#cb30-17"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb30-18"><a href="#cb30-18"></a>    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, b, b)</span>
<span id="cb30-19"><a href="#cb30-19"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb30-20"><a href="#cb30-20"></a>  }</span>
<span id="cb30-21"><a href="#cb30-21"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb30-22"><a href="#cb30-22"></a>}</span>
<span id="cb30-23"><a href="#cb30-23"></a><span class="kw">plot</span>(beta_alpha, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb30-24"><a href="#cb30-24"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb30-25"><a href="#cb30-25"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb30-26"><a href="#cb30-26"></a><span class="kw">lines</span>(beta_alpha, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb30-27"><a href="#cb30-27"></a><span class="kw">lines</span>(beta_alpha, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="when-the-paramenter-of-betaalphaalphais-smallpower-value-alpha-value-0.1soreject-the-hypothesis-of-normalitywhen-the-paramenter-of-betaalphaalphais-very-largethe-distribution-is-approach-normal-distribution." class="section level4">
<h4>when the paramenter of <span class="math inline">\(Beta(\alpha,\alpha)\)</span>is small,power value &lt; alpha value 0.1,so,reject the hypothesis of normality,when the paramenter of <span class="math inline">\(Beta(\alpha,\alpha)\)</span>is very large,the distribution is approach normal distribution.</h4>
</div>
<div id="estimate-the-power-of-the-skewness-test-of-normality-against-symmetric-tv-distributions" class="section level4">
<h4>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(t(v)\)</span> distributions</h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb31-2"><a href="#cb31-2"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb31-3"><a href="#cb31-3"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb31-6"><a href="#cb31-6"></a>}</span>
<span id="cb31-7"><a href="#cb31-7"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb31-9"><a href="#cb31-9"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>v &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="dv">2</span>)</span>
<span id="cb31-11"><a href="#cb31-11"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(v)</span>
<span id="cb31-12"><a href="#cb31-12"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb31-13"><a href="#cb31-13"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb31-14"><a href="#cb31-14"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb31-15"><a href="#cb31-15"></a>  b &lt;-<span class="st"> </span>v[j]</span>
<span id="cb31-16"><a href="#cb31-16"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb31-17"><a href="#cb31-17"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb31-18"><a href="#cb31-18"></a>    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, v)</span>
<span id="cb31-19"><a href="#cb31-19"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb31-20"><a href="#cb31-20"></a>  }</span>
<span id="cb31-21"><a href="#cb31-21"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb31-22"><a href="#cb31-22"></a>}</span>
<span id="cb31-23"><a href="#cb31-23"></a><span class="kw">plot</span>(v, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(beta_alpha), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb31-24"><a href="#cb31-24"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb31-25"><a href="#cb31-25"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb31-26"><a href="#cb31-26"></a><span class="kw">lines</span>(v, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb31-27"><a href="#cb31-27"></a><span class="kw">lines</span>(v, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="the-distribution-of-tv-approach-the-normal-distribution." class="section level4">
<h4>The distribution of <span class="math inline">\(t(v)\)</span> approach the normal distribution.</h4>
</div>
</div>
<div id="question6.8" class="section level1">
<h1>Question6.8</h1>
<div id="refer-to-example-6.16.-repeat-the-simulation-but-also-compute-the-f-test-of-equal-variance-at-significance-level-hatalphadot0.055.-compare-the-power-of-the-count-five-test-and-f-test-for-small-medium-and-large-sample-sizes." class="section level4">
<h4>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}\dot=0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes.</h4>
</div>
</div>
<div id="answer6.8" class="section level1">
<h1>Answer6.8</h1>
<div id="section" class="section level4">
<h4></h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb32-2"><a href="#cb32-2"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb32-3"><a href="#cb32-3"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb32-4"><a href="#cb32-4"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb32-5"><a href="#cb32-5"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb32-8"><a href="#cb32-8"></a>}</span>
<span id="cb32-9"><a href="#cb32-9"></a>ftest &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,alpha,n){</span>
<span id="cb32-10"><a href="#cb32-10"></a>  fvalue &lt;-<span class="st"> </span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">var</span>(y)</span>
<span id="cb32-11"><a href="#cb32-11"></a>  u &lt;-<span class="st"> </span><span class="kw">as.integer</span>(fvalue <span class="op">&lt;</span><span class="st"> </span><span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n,n) <span class="op">|</span><span class="st"> </span>fvalue<span class="op">&gt;</span><span class="st"> </span><span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n,n))</span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="kw">return</span>(u)</span>
<span id="cb32-13"><a href="#cb32-13"></a>}</span>
<span id="cb32-14"><a href="#cb32-14"></a>m &lt;-<span class="dv">10000</span></span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb32-16"><a href="#cb32-16"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb32-17"><a href="#cb32-17"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb32-18"><a href="#cb32-18"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.055</span></span>
<span id="cb32-19"><a href="#cb32-19"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb32-20"><a href="#cb32-20"></a>results &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="kw">length</span>(n),<span class="dv">3</span>)</span>
<span id="cb32-21"><a href="#cb32-21"></a>results[,<span class="dv">1</span>] &lt;-<span class="st"> </span>n</span>
<span id="cb32-22"><a href="#cb32-22"></a>power1 &lt;-<span class="st"> </span>power2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb32-24"><a href="#cb32-24"></a>  power1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb32-25"><a href="#cb32-25"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb32-26"><a href="#cb32-26"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb32-27"><a href="#cb32-27"></a>    <span class="kw">count5test</span>(x, y)</span>
<span id="cb32-28"><a href="#cb32-28"></a>  }))</span>
<span id="cb32-29"><a href="#cb32-29"></a>  power2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb32-30"><a href="#cb32-30"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb32-31"><a href="#cb32-31"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb32-32"><a href="#cb32-32"></a>    <span class="kw">ftest</span>(x,y,alpha,n[i])</span>
<span id="cb32-33"><a href="#cb32-33"></a>  }))</span>
<span id="cb32-34"><a href="#cb32-34"></a>  results[i,<span class="dv">2</span>] &lt;-<span class="st"> </span>power1[i]</span>
<span id="cb32-35"><a href="#cb32-35"></a>  results[i,<span class="dv">3</span>] &lt;-<span class="st"> </span>power2[i]</span>
<span id="cb32-36"><a href="#cb32-36"></a>}</span>
<span id="cb32-37"><a href="#cb32-37"></a><span class="kw">print</span>(results)</span></code></pre></div>
<pre><code>##      [,1]   [,2] [,3]
## [1,]    5 0.0000    1
## [2,]   10 0.1089    1
## [3,]   20 0.3124    1
## [4,]   50 0.6585    1
## [5,]  100 0.8453    1
## [6,]  200 0.9488    1
## [7,]  500 0.9920    1
## [8,] 1000 0.9969    1</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">plot</span>(results[,<span class="dv">1</span>], results[,<span class="dv">2</span>], <span class="dt">col=</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb34-2"><a href="#cb34-2"></a>     <span class="dt">xlab =</span> <span class="kw">bquote</span>(n), <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw">lines</span>(results[,<span class="dv">1</span>], results[,<span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="kw">abline</span>(<span class="dt">h =</span> alpha, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="kw">legend</span>(<span class="st">&quot;right&quot;</span>, <span class="dv">1</span>, <span class="kw">c</span>(<span class="st">&quot;count5test&quot;</span>, <span class="st">&quot;ftest&quot;</span>),</span>
<span id="cb34-6"><a href="#cb34-6"></a>       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>), <span class="dt">inset =</span> <span class="fl">.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question6.c" class="section level1">
<h1>Question6.C</h1>
<div id="repeat-examples-6.8-and-6.10-for-mardias-multivariate-skewness-test.-mardia187-proposed-tests-of-multivariate-normality-based-on-multivariate-generalizations-of-skewness-and-kurtosis." class="section level4">
<h4>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia[187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis.</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb35-2"><a href="#cb35-2"></a>n &lt;-<span class="st"> </span><span class="dv">10</span> <span class="co">#num. of sample</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>d &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co">#dim. of sample</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. of experiment</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb35-6"><a href="#cb35-6"></a>u &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb35-8"><a href="#cb35-8"></a>  mean &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">numeric</span>(d))</span>
<span id="cb35-9"><a href="#cb35-9"></a>  sigma &lt;-<span class="st"> </span><span class="kw">diag</span>(d)</span>
<span id="cb35-10"><a href="#cb35-10"></a>  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,mean,sigma) <span class="co">#generate sample</span></span>
<span id="cb35-11"><a href="#cb35-11"></a>  hat_sigma &lt;-<span class="st"> </span><span class="kw">cov</span>(x)</span>
<span id="cb35-12"><a href="#cb35-12"></a>  inf_hat_sigma &lt;-<span class="st"> </span><span class="kw">solve</span>(hat_sigma)</span>
<span id="cb35-13"><a href="#cb35-13"></a>  x_bar &lt;-<span class="st"> </span><span class="kw">apply</span>(x,<span class="dv">2</span>,mean)</span>
<span id="cb35-14"><a href="#cb35-14"></a>  cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb35-15"><a href="#cb35-15"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb35-16"><a href="#cb35-16"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb35-17"><a href="#cb35-17"></a>      b &lt;-<span class="st"> </span>(<span class="kw">t</span>(x[i,]<span class="op">-</span>x_bar) <span class="op">%*%</span><span class="st"> </span>inf_hat_sigma <span class="op">%*%</span><span class="st"> </span>(x[j,]<span class="op">-</span>x_bar))<span class="op">^</span><span class="dv">3</span><span class="op">/</span>n<span class="op">^</span><span class="dv">2</span></span>
<span id="cb35-18"><a href="#cb35-18"></a>    }</span>
<span id="cb35-19"><a href="#cb35-19"></a>  }</span>
<span id="cb35-20"><a href="#cb35-20"></a>  u[k] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(b <span class="op">&lt;</span><span class="st"> </span>cv <span class="op">|</span><span class="st"> </span>b <span class="op">&gt;</span><span class="st"> </span>cv)</span>
<span id="cb35-21"><a href="#cb35-21"></a>}</span>
<span id="cb35-22"><a href="#cb35-22"></a><span class="kw">print</span>(<span class="kw">mean</span>(u))  </span></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
</div>
<div id="dicussion" class="section level1">
<h1>Dicussion</h1>
<div id="if-we-obtain-the-powers-for-two-methods-under-a-particular-simulation-setting-with-10000-experiments-say-0.651-for-one-method-and-0.676-for-another-method.-can-we-say-the-powers-are-different-at-0.05-level" class="section level4">
<h4>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</h4>
</div>
<div id="what-is-the-corresponding-hypothesis-test-problem" class="section level4">
<h4>1.What is the corresponding hypothesis test problem?</h4>
</div>
<div id="what-test-should-we-use-z-test-two-sample-t-test-paired-t-test-or-mcnemar-test" class="section level4">
<h4>2.What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</h4>
</div>
<div id="what-information-is-needed-to-test-your-hypothesis" class="section level4">
<h4>3.What information is needed to test your hypothesis?</h4>
</div>
</div>
<div id="answer" class="section level1">
<h1>Answer</h1>
<div id="the-corresponding-hypothesis-is-h_0power_1power_2-quad-h_1power_1notpower_2" class="section level4">
<h4>1.the corresponding hypothesis is <span class="math display">\[H_0:power_1=power_2 \quad H_1:power_1\not=power_2\]</span></h4>
</div>
<div id="two-sample-t-test-we-cant-usebecause-in-the-same-experiment-the-sample-is-not-independent.the-other-methods-can-be-used." class="section level4">
<h4>2.Two-sample t-test we can’t use,because in the same experiment the sample is not independent.The other methods can be used.</h4>
</div>
<div id="we-should-get-the-resultspower1-and-power2-of-10000-experiments-with-two-mothodstest-h_0-at-0.05-level-use-one-of-the-test-methods-above." class="section level4">
<h4>3.we should get the results(power1 and power2) of 10000 experiments with two mothods,test <span class="math inline">\(H_0\)</span> at 0.05 level use one of the test methods above.</h4>
</div>
</div>
<div id="a-20066-2020-11-03" class="section level1">
<h1>A-20066-2020-11-03</h1>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
</div>
<div id="question7.1" class="section level1">
<h1>Question7.1</h1>
<div id="compute-a-jackknife-estimate-of-the-bias-and-the-standard-error-of-the-correlation-statistic-in-example-7.2." class="section level4">
<h4>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</h4>
</div>
</div>
<div id="answer7.1" class="section level1">
<h1>Answer7.1</h1>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb37-2"><a href="#cb37-2"></a>x &lt;-<span class="st"> </span>law</span>
<span id="cb37-3"><a href="#cb37-3"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb37-4"><a href="#cb37-4"></a>b.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])</span>
<span id="cb37-5"><a href="#cb37-5"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">b.cor</span>(x,<span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb37-6"><a href="#cb37-6"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb37-8"><a href="#cb37-8"></a>  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">b.cor</span>(x,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])</span>
<span id="cb37-9"><a href="#cb37-9"></a>}</span>
<span id="cb37-10"><a href="#cb37-10"></a>bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb37-11"><a href="#cb37-11"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb37-12"><a href="#cb37-12"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias.jack=</span>bias.jack,</span>
<span id="cb37-13"><a href="#cb37-13"></a>        <span class="dt">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.776    -0.006     0.143</code></pre>
</div>
<div id="question-7.5" class="section level1">
<h1>Question 7.5</h1>
<div id="refer-to-exercise-7.4.-compute-95-bootstrap-confidence-intervals-for-the-mean-time-between-failures-1λ-by-the-standard-normal-basic-percentile-and-bca-methods.-compare-the-intervals-and-explain-why-they-may-differ." class="section level4">
<h4>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures 1/λ by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">library</span>(boot);<span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a>dat&lt;-<span class="kw">cbind</span>(aircondit<span class="op">$</span>hours)</span>
<span id="cb39-3"><a href="#cb39-3"></a>boot.mean &lt;-<span class="st"> </span><span class="cf">function</span>(x,ind) <span class="kw">mean</span>(x[ind,<span class="dv">1</span>])</span>
<span id="cb39-4"><a href="#cb39-4"></a>de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>dat,<span class="dt">statistic=</span>boot.mean, <span class="dt">R =</span> <span class="dv">1000</span>)</span>
<span id="cb39-5"><a href="#cb39-5"></a>ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="kw">print</span>(ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = de, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.3, 182.0 )   ( 25.8, 169.2 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.9, 190.4 )   ( 56.9, 231.8 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
<div id="one-reason-for-the-difference-in-the-percentile-and-normal-confidence-intervals-could-be-that-the-sampling-distribution-of-correlation-statistic-is-not-close-to-normal.-when-the-sampling-distribution-of-the-statistic-is-approximately-normal-the-percentile-interval-will-agree-with-the-normal-interval." class="section level4">
<h4>One reason for the difference in the percentile and normal confidence intervals could be that the sampling distribution of correlation statistic is not close to normal. When the sampling distribution of the statistic is approximately normal, the percentile interval will agree with the normal interval.</h4>
</div>
<div id="the-bootstrap-percentile-interval-is-transformation-respecting-but-only-first-order-accurate.-the-standard-normal-confidence-interval-is-neither-transformation-respecting-nor-second-order-accurate.there-are-two-important-theoretical-advantages-to-bca-bootstrap-confidence-intervals.-the-bca-confidence-intervals-are-transformation-respecting-and-bca-intervals-have-second-order-accuracy.bca-percentile-intervals-are-a-modified-version-of-percentile-intervals-that-have-better-theoretical-properties-and-better-performance-in-practice." class="section level4">
<h4>The bootstrap percentile interval is transformation respecting but only first order accurate. The standard normal confidence interval is neither transformation respecting nor second order accurate.There are two important theoretical advantages to BCa bootstrap confidence intervals. The BCa confidence intervals are transformation respecting and BCa intervals have second order accuracy.BCa percentile intervals are a modified version of percentile intervals that have better theoretical properties and better performance in practice.</h4>
</div>
</div>
<div id="question7.8" class="section level1">
<h1>Question7.8</h1>
<div id="refer-to-exercise-7.7.-obtain-the-jackknife-estimates-of-bias-and-standard-error-of-hattheta." class="section level4">
<h4>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb41-2"><a href="#cb41-2"></a>x&lt;-scor</span>
<span id="cb41-3"><a href="#cb41-3"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb41-4"><a href="#cb41-4"></a>b.cov &lt;-<span class="st"> </span><span class="cf">function</span>(x,i,n){</span>
<span id="cb41-5"><a href="#cb41-5"></a>  M&lt;-((n<span class="dv">-1</span>)<span class="op">/</span>n)<span class="op">*</span><span class="kw">cov</span>(x[i,])</span>
<span id="cb41-6"><a href="#cb41-6"></a>  ev &lt;-<span class="st"> </span><span class="kw">eigen</span>(M)</span>
<span id="cb41-7"><a href="#cb41-7"></a>  s&lt;-<span class="kw">sum</span>(ev<span class="op">$</span>values)</span>
<span id="cb41-8"><a href="#cb41-8"></a>  theta_hat&lt;-<span class="kw">max</span>(ev<span class="op">$</span>values)<span class="op">/</span>s</span>
<span id="cb41-9"><a href="#cb41-9"></a>  <span class="kw">return</span>(theta_hat)</span>
<span id="cb41-10"><a href="#cb41-10"></a>}</span>
<span id="cb41-11"><a href="#cb41-11"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">b.cov</span>(x,(<span class="dv">1</span><span class="op">:</span>n),n)</span>
<span id="cb41-12"><a href="#cb41-12"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb41-14"><a href="#cb41-14"></a>  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">b.cov</span>(x,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i],n)</span>
<span id="cb41-15"><a href="#cb41-15"></a>}</span>
<span id="cb41-16"><a href="#cb41-16"></a>bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb41-17"><a href="#cb41-17"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb41-18"><a href="#cb41-18"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias.jack=</span>bias.jack,</span>
<span id="cb41-19"><a href="#cb41-19"></a>        <span class="dt">se.jack=</span>se.jack),<span class="dv">6</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##  0.619115  0.001069  0.049552</code></pre>
</div>
</div>
<div id="question7.11" class="section level1">
<h1>Question7.11</h1>
<div id="in-example-7.18-leave-one-out-n-fold-cross-validation-was-used-to-select-the-best-fitting-model.-use-leave-two-out-cross-validation-to-compare-the-models." class="section level4">
<h4>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">library</span>(plyr)</span>
<span id="cb43-2"><a href="#cb43-2"></a>CVgroup &lt;-<span class="st"> </span><span class="cf">function</span>(k,datasize,seed){</span>
<span id="cb43-3"><a href="#cb43-3"></a>  cvlist &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb43-4"><a href="#cb43-4"></a>  <span class="kw">set.seed</span>(seed)</span>
<span id="cb43-5"><a href="#cb43-5"></a>  n &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>k,<span class="kw">ceiling</span>(datasize<span class="op">/</span>k))[<span class="dv">1</span><span class="op">:</span>datasize]    <span class="co">#将数据分成K份，并生成的完成数据集n</span></span>
<span id="cb43-6"><a href="#cb43-6"></a>  temp &lt;-<span class="st"> </span><span class="kw">sample</span>(n,datasize)   <span class="co">#把n打乱</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>  x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>k</span>
<span id="cb43-8"><a href="#cb43-8"></a>  dataseq &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>datasize</span>
<span id="cb43-9"><a href="#cb43-9"></a>  cvlist &lt;-<span class="st"> </span><span class="kw">lapply</span>(x,<span class="cf">function</span>(x) dataseq[temp<span class="op">==</span>x])  <span class="co">#dataseq中随机生成k个随机有序数据列</span></span>
<span id="cb43-10"><a href="#cb43-10"></a>  <span class="kw">return</span>(cvlist)</span>
<span id="cb43-11"><a href="#cb43-11"></a>}</span>
<span id="cb43-12"><a href="#cb43-12"></a><span class="kw">library</span>(DAAG); </span></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:plyr&#39;:
## 
##     ozone</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>data&lt;-ironslag</span>
<span id="cb50-2"><a href="#cb50-2"></a>k &lt;-<span class="st"> </span><span class="dv">26</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>datasize &lt;-<span class="st"> </span><span class="kw">length</span>(data<span class="op">$</span>magnetic)<span class="op">-</span><span class="dv">1</span>   <span class="co">#样本有53个，去掉1个样本，用剩下的52个样本做26折交叉验证，每个subset中包含2个样本</span></span>
<span id="cb50-4"><a href="#cb50-4"></a>cvlist &lt;-<span class="st"> </span><span class="kw">CVgroup</span>(<span class="dt">k =</span> k,<span class="dt">datasize =</span> datasize,<span class="dt">seed =</span> <span class="dv">1206</span>)</span>
<span id="cb50-5"><a href="#cb50-5"></a>cvlist   <span class="co">#生成样本分组情况</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 20 52
## 
## [[2]]
## [1] 24 46
## 
## [[3]]
## [1] 29 31
## 
## [[4]]
## [1]  2 41
## 
## [[5]]
## [1] 49 50
## 
## [[6]]
## [1] 15 22
## 
## [[7]]
## [1] 32 43
## 
## [[8]]
## [1] 10 21
## 
## [[9]]
## [1]  5 11
## 
## [[10]]
## [1] 36 45
## 
## [[11]]
## [1] 44 48
## 
## [[12]]
## [1] 12 42
## 
## [[13]]
## [1] 39 40
## 
## [[14]]
## [1] 25 27
## 
## [[15]]
## [1] 3 9
## 
## [[16]]
## [1]  4 14
## 
## [[17]]
## [1]  1 47
## 
## [[18]]
## [1] 13 16
## 
## [[19]]
## [1]  7 34
## 
## [[20]]
## [1] 17 19
## 
## [[21]]
## [1] 23 37
## 
## [[22]]
## [1] 26 33
## 
## [[23]]
## [1] 18 51
## 
## [[24]]
## [1] 28 30
## 
## [[25]]
## [1] 6 8
## 
## [[26]]
## [1] 35 38</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,k,<span class="dv">2</span>)</span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="co"># for k-fold cross validation</span></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb52-4"><a href="#cb52-4"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">26</span>) {</span>
<span id="cb52-5"><a href="#cb52-5"></a>  y &lt;-<span class="st"> </span>data<span class="op">$</span>magnetic[<span class="op">-</span>cvlist[[k]]]</span>
<span id="cb52-6"><a href="#cb52-6"></a>  x &lt;-<span class="st"> </span>data<span class="op">$</span>chemical[<span class="op">-</span>cvlist[[k]]]</span>
<span id="cb52-7"><a href="#cb52-7"></a>  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb52-8"><a href="#cb52-8"></a>  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>data<span class="op">$</span>chemical[cvlist[[k]]]</span>
<span id="cb52-9"><a href="#cb52-9"></a>  e1[k,] &lt;-<span class="st"> </span>data<span class="op">$</span>magnetic[cvlist[[k]]] <span class="op">-</span><span class="st"> </span>yhat1</span>
<span id="cb52-10"><a href="#cb52-10"></a>  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb52-11"><a href="#cb52-11"></a>  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>data<span class="op">$</span>chemical[cvlist[[k]]] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>data<span class="op">$</span>chemical[cvlist[[k]]]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb52-12"><a href="#cb52-12"></a>  e2[k,] &lt;-<span class="st"> </span>data<span class="op">$</span>magnetic[cvlist[[k]]] <span class="op">-</span><span class="st"> </span>yhat2</span>
<span id="cb52-13"><a href="#cb52-13"></a>  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb52-14"><a href="#cb52-14"></a>  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>data<span class="op">$</span>chemical[cvlist[[k]]]</span>
<span id="cb52-15"><a href="#cb52-15"></a>  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb52-16"><a href="#cb52-16"></a>  e3[k,] &lt;-<span class="st"> </span>data<span class="op">$</span>magnetic[cvlist[[k]]] <span class="op">-</span><span class="st"> </span>yhat3</span>
<span id="cb52-17"><a href="#cb52-17"></a>  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb52-18"><a href="#cb52-18"></a>  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(data<span class="op">$</span>chemical[cvlist[[k]]])</span>
<span id="cb52-19"><a href="#cb52-19"></a>  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb52-20"><a href="#cb52-20"></a>  e4[k,] &lt;-<span class="st"> </span>data<span class="op">$</span>magnetic[cvlist[[k]]] <span class="op">-</span><span class="st"> </span>yhat4</span>
<span id="cb52-21"><a href="#cb52-21"></a>}</span>
<span id="cb52-22"><a href="#cb52-22"></a></span>
<span id="cb52-23"><a href="#cb52-23"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))   <span class="co">#计算均方误差</span></span></code></pre></div>
<pre><code>## [1] 18.61833 16.84798 17.21716 19.16508</code></pre>
</div>
<div id="according-to-the-prediction-error-criterion-model-2-the-quadratic-modelwould-be-the-best-fit-for-the-data." class="section level4">
<h4>According to the prediction error criterion, Model 2, the quadratic model,would be the best fit for the data.</h4>
</div>
</div>
<div id="a-20066-2020-11-10" class="section level1">
<h1>A-20066-2020-11-10</h1>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
</div>
<div id="question8.3" class="section level1">
<h1>Question8.3</h1>
<div id="the-count-5-test-for-equal-variances-in-section-6.4-is-based-on-the-maximum-number-of-extreme-points.-example-6.15-shows-that-the-count-5-criterion-is-not-applicable-for-unequal-sample-sizes.-implement-a-permutation-test-for-equal-variance-based-on-the-maximum-number-of-extreme-points-that-applies-when-sample-sizes-are-not-necessarily-equal." class="section level4">
<h4>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</h4>
</div>
</div>
<div id="answer8.3" class="section level1">
<h1>Answer8.3</h1>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb54-4"><a href="#cb54-4"></a>sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>m=<span class="dv">1000</span></span>
<span id="cb54-6"><a href="#cb54-6"></a>K=<span class="dv">1</span><span class="op">:</span><span class="dv">50</span></span>
<span id="cb54-7"><a href="#cb54-7"></a>R=<span class="dv">999</span></span>
<span id="cb54-8"><a href="#cb54-8"></a>reps=<span class="kw">numeric</span>(R)</span>
<span id="cb54-9"><a href="#cb54-9"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb54-10"><a href="#cb54-10"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb54-11"><a href="#cb54-11"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb54-12"><a href="#cb54-12"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb54-13"><a href="#cb54-13"></a>  z=<span class="kw">c</span>(X,Y)</span>
<span id="cb54-14"><a href="#cb54-14"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb54-15"><a href="#cb54-15"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb54-16"><a href="#cb54-16"></a>  t0=<span class="kw">max</span>(<span class="kw">c</span>(outx, outy))</span>
<span id="cb54-17"><a href="#cb54-17"></a>  z=<span class="kw">c</span>(X,Y)</span>
<span id="cb54-18"><a href="#cb54-18"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb54-19"><a href="#cb54-19"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb54-20"><a href="#cb54-20"></a>    k=<span class="kw">sample</span>(K,<span class="dt">size=</span><span class="dv">25</span>,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb54-21"><a href="#cb54-21"></a>    x1=z[k]</span>
<span id="cb54-22"><a href="#cb54-22"></a>    y1=z[<span class="op">-</span>k]</span>
<span id="cb54-23"><a href="#cb54-23"></a>    X &lt;-<span class="st"> </span>x1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x1)</span>
<span id="cb54-24"><a href="#cb54-24"></a>    Y &lt;-<span class="st"> </span>y1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y1)</span>
<span id="cb54-25"><a href="#cb54-25"></a>    outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb54-26"><a href="#cb54-26"></a>    outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb54-27"><a href="#cb54-27"></a>    reps[i]=<span class="kw">max</span>(<span class="kw">c</span>(outx, outy))</span>
<span id="cb54-28"><a href="#cb54-28"></a>  }</span>
<span id="cb54-29"><a href="#cb54-29"></a>  <span class="kw">return</span>(<span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0,reps))<span class="op">&gt;</span><span class="dv">5</span>))</span>
<span id="cb54-30"><a href="#cb54-30"></a>}</span>
<span id="cb54-31"><a href="#cb54-31"></a>alpha=<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb54-32"><a href="#cb54-32"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb54-33"><a href="#cb54-33"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb54-34"><a href="#cb54-34"></a>  x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb54-35"><a href="#cb54-35"></a>  y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb54-36"><a href="#cb54-36"></a>  <span class="kw">count5test</span>(x, y)</span>
<span id="cb54-37"><a href="#cb54-37"></a>}))</span>
<span id="cb54-38"><a href="#cb54-38"></a>alpha</span></code></pre></div>
<pre><code>## [1] 0.063164</code></pre>
</div>
<div id="question-2" class="section level1">
<h1>Question 2</h1>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations</p>
<p>1.Unequal variances and equal expectations 2.Unequal variances and unequal expectations 3.Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) 4.Unbalanced samples (say, 1 case versus 10 controls) 5.Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p>
</div>
<div id="answer1." class="section level1">
<h1>Answer1.</h1>
<p><span class="math display">\[F\sim N(0,1^2)\quad G\sim N(0,1.5^2)\]</span></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">library</span>(RANN) </span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="kw">library</span>(Ball)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">library</span>(energy)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a>mu1=<span class="dv">0</span></span>
<span id="cb62-3"><a href="#cb62-3"></a>mu2=<span class="dv">0</span></span>
<span id="cb62-4"><a href="#cb62-4"></a>sigma1=<span class="dv">1</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>sigma2=<span class="fl">1.5</span></span>
<span id="cb62-6"><a href="#cb62-6"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb62-7"><a href="#cb62-7"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb62-8"><a href="#cb62-8"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb62-9"><a href="#cb62-9"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb62-10"><a href="#cb62-10"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb62-11"><a href="#cb62-11"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb62-12"><a href="#cb62-12"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb62-13"><a href="#cb62-13"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb62-14"><a href="#cb62-14"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb62-15"><a href="#cb62-15"></a>}</span>
<span id="cb62-16"><a href="#cb62-16"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.3</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb62-17"><a href="#cb62-17"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb62-18"><a href="#cb62-18"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb62-19"><a href="#cb62-19"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb62-20"><a href="#cb62-20"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb62-21"><a href="#cb62-21"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb62-22"><a href="#cb62-22"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb62-23"><a href="#cb62-23"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb62-24"><a href="#cb62-24"></a>}</span>
<span id="cb62-25"><a href="#cb62-25"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb62-26"><a href="#cb62-26"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb62-27"><a href="#cb62-27"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu1,sigma1),<span class="dt">ncol=</span>p);</span>
<span id="cb62-28"><a href="#cb62-28"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu2,sigma2),<span class="dt">ncol=</span>p);</span>
<span id="cb62-29"><a href="#cb62-29"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb62-30"><a href="#cb62-30"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb62-31"><a href="#cb62-31"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb62-32"><a href="#cb62-32"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb62-33"><a href="#cb62-33"></a>}</span>
<span id="cb62-34"><a href="#cb62-34"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb62-35"><a href="#cb62-35"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb62-36"><a href="#cb62-36"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.478 0.585 0.937</code></pre>
<p>power of nn = 0.478 power of energy = 0.585 power of ball = 0.937</p>
</div>
<div id="answer2." class="section level1">
<h1>Answer2.</h1>
<p><span class="math display">\[F\sim N(0,1^2)\quad G\sim N(0.5,1.5^2)\]</span></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">library</span>(RANN) </span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="kw">library</span>(energy)</span>
<span id="cb64-5"><a href="#cb64-5"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb64-6"><a href="#cb64-6"></a>mu1=<span class="dv">0</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>mu2=<span class="fl">0.5</span></span>
<span id="cb64-8"><a href="#cb64-8"></a>sigma1=<span class="dv">1</span></span>
<span id="cb64-9"><a href="#cb64-9"></a>sigma2=<span class="fl">1.5</span></span>
<span id="cb64-10"><a href="#cb64-10"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb64-11"><a href="#cb64-11"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb64-12"><a href="#cb64-12"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb64-13"><a href="#cb64-13"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb64-14"><a href="#cb64-14"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb64-15"><a href="#cb64-15"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb64-16"><a href="#cb64-16"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb64-17"><a href="#cb64-17"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb64-18"><a href="#cb64-18"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb64-19"><a href="#cb64-19"></a>}</span>
<span id="cb64-20"><a href="#cb64-20"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.3</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb64-21"><a href="#cb64-21"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb64-22"><a href="#cb64-22"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb64-23"><a href="#cb64-23"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb64-24"><a href="#cb64-24"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb64-25"><a href="#cb64-25"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb64-26"><a href="#cb64-26"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb64-27"><a href="#cb64-27"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb64-28"><a href="#cb64-28"></a>}</span>
<span id="cb64-29"><a href="#cb64-29"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb64-30"><a href="#cb64-30"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb64-31"><a href="#cb64-31"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu1,sigma1),<span class="dt">ncol=</span>p);</span>
<span id="cb64-32"><a href="#cb64-32"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu2,sigma2),<span class="dt">ncol=</span>p);</span>
<span id="cb64-33"><a href="#cb64-33"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb64-34"><a href="#cb64-34"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb64-35"><a href="#cb64-35"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb64-36"><a href="#cb64-36"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb64-37"><a href="#cb64-37"></a>}</span>
<span id="cb64-38"><a href="#cb64-38"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb64-39"><a href="#cb64-39"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb64-40"><a href="#cb64-40"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.701 0.958 0.988</code></pre>
<p>power of nn = 0.701 power of energy = 0.958 power of ball = 0.988</p>
</div>
<div id="answer3." class="section level1">
<h1>Answer3.</h1>
<div id="bimodel-distribution" class="section level4">
<h4>bimodel distribution:</h4>
<p><span class="math display">\[0.4N(0,1)+0.6N(0,10^2)\]</span></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="kw">library</span>(RANN) </span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="kw">library</span>(energy)</span>
<span id="cb66-5"><a href="#cb66-5"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb66-6"><a href="#cb66-6"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb66-7"><a href="#cb66-7"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb66-8"><a href="#cb66-8"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb66-9"><a href="#cb66-9"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb66-10"><a href="#cb66-10"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb66-11"><a href="#cb66-11"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb66-12"><a href="#cb66-12"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb66-13"><a href="#cb66-13"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb66-14"><a href="#cb66-14"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb66-15"><a href="#cb66-15"></a>}</span>
<span id="cb66-16"><a href="#cb66-16"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.3</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb66-17"><a href="#cb66-17"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb66-18"><a href="#cb66-18"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb66-19"><a href="#cb66-19"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb66-20"><a href="#cb66-20"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb66-21"><a href="#cb66-21"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb66-22"><a href="#cb66-22"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb66-23"><a href="#cb66-23"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb66-24"><a href="#cb66-24"></a>}</span>
<span id="cb66-25"><a href="#cb66-25"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb66-26"><a href="#cb66-26"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb66-27"><a href="#cb66-27"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb66-28"><a href="#cb66-28"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb66-29"><a href="#cb66-29"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb66-30"><a href="#cb66-30"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb66-31"><a href="#cb66-31"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb66-32"><a href="#cb66-32"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb66-33"><a href="#cb66-33"></a>}</span>
<span id="cb66-34"><a href="#cb66-34"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb66-35"><a href="#cb66-35"></a>pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb66-36"><a href="#cb66-36"></a>pow1</span></code></pre></div>
<pre><code>## [1] 0.102 0.097 0.094</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb68-2"><a href="#cb68-2"></a>sigma=<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">size =</span> n1<span class="op">*</span>p,</span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>))</span>
<span id="cb68-4"><a href="#cb68-4"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p, <span class="dv">0</span>, sigma),<span class="dt">ncol=</span>p);</span>
<span id="cb68-5"><a href="#cb68-5"></a>sigma=<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">size =</span> n1<span class="op">*</span>p,</span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>))</span>
<span id="cb68-7"><a href="#cb68-7"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p, <span class="dv">0</span>, sigma),<span class="dt">ncol=</span>p);</span>
<span id="cb68-8"><a href="#cb68-8"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb68-9"><a href="#cb68-9"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb68-10"><a href="#cb68-10"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb68-11"><a href="#cb68-11"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb68-12"><a href="#cb68-12"></a>}</span>
<span id="cb68-13"><a href="#cb68-13"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb68-14"><a href="#cb68-14"></a>pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb68-15"><a href="#cb68-15"></a>pow2</span></code></pre></div>
<pre><code>## [1] 0.092 0.091 0.104</code></pre>
<p>t(1): power of nn = 0.102 power of energy = 0.097 power of ball = 0.094</p>
<p>bimodel distribution: power of nn = 0.092 power of energy = 0.091 power of ball = 0.104</p>
</div>
</div>
<div id="answer4." class="section level1">
<h1>Answer4.</h1>
<p><span class="math display">\[X=\{X_1,...X_{10}\}\quad Y=\{Y_1,...,Y_{100}\}\quad X,Y\sim N(0,1)\]</span></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">library</span>(RANN) </span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb70-4"><a href="#cb70-4"></a><span class="kw">library</span>(energy)</span>
<span id="cb70-5"><a href="#cb70-5"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb70-6"><a href="#cb70-6"></a>mu1=<span class="dv">0</span></span>
<span id="cb70-7"><a href="#cb70-7"></a>mu2=<span class="dv">0</span></span>
<span id="cb70-8"><a href="#cb70-8"></a>sigma1=<span class="dv">1</span></span>
<span id="cb70-9"><a href="#cb70-9"></a>sigma2=<span class="dv">1</span></span>
<span id="cb70-10"><a href="#cb70-10"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb70-11"><a href="#cb70-11"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb70-12"><a href="#cb70-12"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb70-13"><a href="#cb70-13"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb70-14"><a href="#cb70-14"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb70-15"><a href="#cb70-15"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb70-16"><a href="#cb70-16"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb70-17"><a href="#cb70-17"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb70-18"><a href="#cb70-18"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb70-19"><a href="#cb70-19"></a>}</span>
<span id="cb70-20"><a href="#cb70-20"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.3</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb70-21"><a href="#cb70-21"></a>n1 &lt;-<span class="dv">10</span>; n2 &lt;-<span class="st"> </span><span class="dv">100</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb70-22"><a href="#cb70-22"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb70-23"><a href="#cb70-23"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb70-24"><a href="#cb70-24"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb70-25"><a href="#cb70-25"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb70-26"><a href="#cb70-26"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb70-27"><a href="#cb70-27"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb70-28"><a href="#cb70-28"></a>}</span>
<span id="cb70-29"><a href="#cb70-29"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb70-30"><a href="#cb70-30"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb70-31"><a href="#cb70-31"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu1,sigma1),<span class="dt">ncol=</span>p);</span>
<span id="cb70-32"><a href="#cb70-32"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,mu2,sigma2),<span class="dt">ncol=</span>p);</span>
<span id="cb70-33"><a href="#cb70-33"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb70-34"><a href="#cb70-34"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb70-35"><a href="#cb70-35"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb70-36"><a href="#cb70-36"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb70-37"><a href="#cb70-37"></a>}</span>
<span id="cb70-38"><a href="#cb70-38"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb70-39"><a href="#cb70-39"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb70-40"><a href="#cb70-40"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.092 0.096 0.097</code></pre>
</div>
<div id="a-20066-2020-11-17" class="section level1">
<h1>A-20066-2020-11-17</h1>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
</div>
<div id="question9.4" class="section level1">
<h1>Question9.4</h1>
<div id="implement-a-random-walk-metropolis-sampler-for-generating-the-standard-laplace-distribution-see-exercise-3.2.-for-the-increment-simulate-from-a-normal-distribution.-compare-the-chains-generated-when-different-variances-are-used-for-the-proposal-distribution.-also-compute-the-acceptance-rates-of-each-chain." class="section level4">
<h4>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</h4>
</div>
</div>
<div id="answer9.4" class="section level1">
<h1>Answer9.4</h1>
<div id="the-pdf-of-the-standard-laplace-distribution-is-fx" class="section level4">
<h4>the PDF of the standard Laplace distribution is <span class="math inline">\(f(x)\)</span></h4>
<p><span class="math display">\[f(x)=\frac{1}{2}e^{-|x|}, \quad x\in{R}\]</span></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>laplace&lt;-<span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}</span>
<span id="cb72-2"><a href="#cb72-2"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb72-3"><a href="#cb72-3"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb72-4"><a href="#cb72-4"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb72-5"><a href="#cb72-5"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb72-6"><a href="#cb72-6"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb72-7"><a href="#cb72-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb72-8"><a href="#cb72-8"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb72-9"><a href="#cb72-9"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">laplace</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">laplace</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb72-10"><a href="#cb72-10"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb72-11"><a href="#cb72-11"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb72-12"><a href="#cb72-12"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb72-13"><a href="#cb72-13"></a>      }</span>
<span id="cb72-14"><a href="#cb72-14"></a>  }</span>
<span id="cb72-15"><a href="#cb72-15"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb72-16"><a href="#cb72-16"></a>}</span>
<span id="cb72-17"><a href="#cb72-17"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb72-18"><a href="#cb72-18"></a>N &lt;-<span class="st"> </span><span class="dv">15000</span></span>
<span id="cb72-19"><a href="#cb72-19"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb72-20"><a href="#cb72-20"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb72-21"><a href="#cb72-21"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb72-22"><a href="#cb72-22"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb72-23"><a href="#cb72-23"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb72-24"><a href="#cb72-24"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb72-25"><a href="#cb72-25"></a><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</span></code></pre></div>
<pre><code>## [1] 4462 7143 8711 9839</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k<span class="op">/</span>N,rw2<span class="op">$</span>k<span class="op">/</span>N,rw3<span class="op">$</span>k<span class="op">/</span>N,rw4<span class="op">$</span>k<span class="op">/</span>N)) <span class="co"># compute the acceptance rates of each chain</span></span></code></pre></div>
<pre><code>## [1] 0.2974667 0.4762000 0.5807333 0.6559333</code></pre>
</div>
</div>
<div id="question2" class="section level1">
<h1>Question2</h1>
<div id="use-the-gelman-rubin-method-to-monitor-convergence-of-the-chainand-run-the-chain-until-it-converges-approximately-to-the-target-distribution-according-to-hatr1.2" class="section level4">
<h4>use the Gelman-Rubin method to monitor convergence of the chain,and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span></h4>
</div>
</div>
<div id="answer2-1" class="section level1">
<h1>Answer2</h1>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb76-2"><a href="#cb76-2"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb76-3"><a href="#cb76-3"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb76-5"><a href="#cb76-5"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb76-6"><a href="#cb76-6"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb76-7"><a href="#cb76-7"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb76-8"><a href="#cb76-8"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb76-9"><a href="#cb76-9"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb76-10"><a href="#cb76-10"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb76-11"><a href="#cb76-11"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb76-12"><a href="#cb76-12"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb76-13"><a href="#cb76-13"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb76-14"><a href="#cb76-14"></a>}</span>
<span id="cb76-15"><a href="#cb76-15"></a>laplace&lt;-<span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}</span>
<span id="cb76-16"><a href="#cb76-16"></a><span class="co">#normal.chain &lt;- function(sigma, x0, N) {</span></span>
<span id="cb76-17"><a href="#cb76-17"></a>  <span class="co">#generates a Metropolis chain for Normal(0,1)</span></span>
<span id="cb76-18"><a href="#cb76-18"></a>  <span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb76-19"><a href="#cb76-19"></a>  <span class="co">#and starting value X</span></span>
<span id="cb76-20"><a href="#cb76-20"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb76-21"><a href="#cb76-21"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb76-22"><a href="#cb76-22"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb76-23"><a href="#cb76-23"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb76-24"><a href="#cb76-24"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb76-25"><a href="#cb76-25"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb76-26"><a href="#cb76-26"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">laplace</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">laplace</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb76-27"><a href="#cb76-27"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb76-28"><a href="#cb76-28"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb76-29"><a href="#cb76-29"></a>      }</span>
<span id="cb76-30"><a href="#cb76-30"></a>  }</span>
<span id="cb76-31"><a href="#cb76-31"></a>  <span class="kw">return</span>(x)</span>
<span id="cb76-32"><a href="#cb76-32"></a>}</span>
<span id="cb76-33"><a href="#cb76-33"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb76-34"><a href="#cb76-34"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>) <span class="co">#parameter of proposal distribution</span></span>
<span id="cb76-35"><a href="#cb76-35"></a>k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb76-36"><a href="#cb76-36"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb76-37"><a href="#cb76-37"></a>b &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co">#burn-in length</span></span>
<span id="cb76-38"><a href="#cb76-38"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb76-39"><a href="#cb76-39"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb76-40"><a href="#cb76-40"></a><span class="co">#generate the chains</span></span>
<span id="cb76-41"><a href="#cb76-41"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb76-42"><a href="#cb76-42"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb76-43"><a href="#cb76-43"></a>  X[i, ] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[i], x0,n)</span>
<span id="cb76-44"><a href="#cb76-44"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb76-45"><a href="#cb76-45"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb76-46"><a href="#cb76-46"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb76-47"><a href="#cb76-47"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb76-48"><a href="#cb76-48"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.021722</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="co">#for (i in 1:k)</span></span>
<span id="cb78-4"><a href="#cb78-4"></a>  <span class="co">#plot(psi[i, (b+1):n], type=&quot;l&quot;,</span></span>
<span id="cb78-5"><a href="#cb78-5"></a>       <span class="co">#xlab=i, ylab=bquote(psi))</span></span>
<span id="cb78-6"><a href="#cb78-6"></a><span class="co">#par(mfrow=c(1,1)) #restore default</span></span>
<span id="cb78-7"><a href="#cb78-7"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb78-8"><a href="#cb78-8"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb78-9"><a href="#cb78-9"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb78-10"><a href="#cb78-10"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb78-11"><a href="#cb78-11"></a><span class="co">#plot(rhat[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;)</span></span>
<span id="cb78-12"><a href="#cb78-12"></a><span class="co">#abline(h=1.1, lty=2)</span></span></code></pre></div>
</div>
<div id="question11.4" class="section level1">
<h1>Question11.4</h1>
<div id="find-the-intersection-points-ak-in-0sqrtk-of-the-curves" class="section level4">
<h4>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves</h4>
<p><span class="math display">\[S_{k-1}(a) = P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})\]</span> and <span class="math display">\[S_k(a) = P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}})\]</span></p>
</div>
<div id="for-k-4-25-100-500-1000-where-tk-is-a-student-t-random-variable-with-k-degrees-of-freedom.-these-intersection-points-determine-the-critical-values-for-a-t-test-for-scale-mixture-errors-proposed-by-szekely-260." class="section level4">
<h4>for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Szekely [260].)</h4>
</div>
</div>
<div id="answer11.4" class="section level1">
<h1>Answer11.4</h1>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>kopt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb79-2"><a href="#cb79-2"></a>Ak &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="kw">length</span>(kopt),<span class="dv">1</span>)</span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="kw">set.seed</span>(<span class="dv">13425</span>)</span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(kopt)){</span>
<span id="cb79-5"><a href="#cb79-5"></a>  k &lt;-<span class="st"> </span>kopt[i]</span>
<span id="cb79-6"><a href="#cb79-6"></a>  f &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k)</span>
<span id="cb79-7"><a href="#cb79-7"></a>  res &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">sqrt</span>(k))<span class="op">-</span><span class="fl">1e-10</span>,<span class="dt">maxiter =</span> <span class="fl">1e6</span>)</span>
<span id="cb79-8"><a href="#cb79-8"></a>  res &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">unlist</span>(res)[<span class="dv">1</span>])</span>
<span id="cb79-9"><a href="#cb79-9"></a>  <span class="cf">if</span>(res<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>res<span class="op">&lt;</span><span class="kw">sqrt</span>(k)) Ak[i] &lt;-<span class="st"> </span>res <span class="cf">else</span> Ak[i] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb79-10"><a href="#cb79-10"></a>}</span>
<span id="cb79-11"><a href="#cb79-11"></a><span class="kw">print</span>(Ak)</span></code></pre></div>
<pre><code>##            [,1]
##  [1,]  1.492103
##  [2,]  1.533549
##  [3,]  1.562768
##  [4,]  1.584421
##  [5,]  1.601182
##  [6,]  1.614517
##  [7,]  1.625356
##  [8,]  1.634398
##  [9,]  1.642026
## [10,]  1.648543
## [11,]  1.654174
## [12,]  1.659100
## [13,]  1.663458
## [14,]  1.667292
## [15,]  1.670738
## [16,]  1.673818
## [17,]  1.676623
## [18,]  1.679137
## [19,]  1.681461
## [20,]  4.795832
## [21,]  4.898979
## [22,]  5.000000
## [23,] 10.000000
## [24,] 22.360680
## [25,]        NA</code></pre>
</div>
<div id="a-20066-2020-11-24" class="section level1">
<h1>A-20066-2020-11-24</h1>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
</div>
<div id="question1" class="section level1">
<h1>Question1</h1>
<div id="use-em-algorithm-to-solve-mle-of-p-and-q-consider-missingdata-n_aa-and-n_bb." class="section level4">
<h4>(1)Use EM algorithm to solve MLE of p and q (consider missingdata <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</h4>
</div>
<div id="record-the-values-of-p-and-q-that-maximize-the-conditional-likelihood-in-each-em-steps-calculate-the-corresponding-log-maximum-likelihood-values-for-observed-data-are-they-increasing" class="section level4">
<h4>(2)Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</h4>
</div>
</div>
<div id="answer1-1" class="section level1">
<h1>Answer1</h1>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>na &lt;-<span class="st"> </span><span class="dv">444</span></span>
<span id="cb81-2"><a href="#cb81-2"></a>nb &lt;-<span class="st"> </span><span class="dv">132</span></span>
<span id="cb81-3"><a href="#cb81-3"></a>noo &lt;-<span class="st"> </span><span class="dv">361</span></span>
<span id="cb81-4"><a href="#cb81-4"></a>nab &lt;-<span class="st"> </span><span class="dv">63</span></span>
<span id="cb81-5"><a href="#cb81-5"></a>n &lt;-<span class="st"> </span>na <span class="op">+</span><span class="st"> </span>nb <span class="op">+</span><span class="st"> </span>noo <span class="op">+</span>nab</span>
<span id="cb81-6"><a href="#cb81-6"></a>k &lt;-<span class="st"> </span><span class="dv">10</span>    <span class="co">#times of iters</span></span>
<span id="cb81-7"><a href="#cb81-7"></a>p &lt;-<span class="st"> </span>q &lt;-<span class="st"> </span>r &lt;-<span class="st"> </span>E &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb81-8"><a href="#cb81-8"></a>p[<span class="dv">1</span>] &lt;-<span class="st"> </span>q[<span class="dv">1</span>] &lt;-<span class="st"> </span>r[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb81-9"><a href="#cb81-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>k){</span>
<span id="cb81-10"><a href="#cb81-10"></a>  p_hat &lt;-<span class="st"> </span>p[i<span class="dv">-1</span>]</span>
<span id="cb81-11"><a href="#cb81-11"></a>  q_hat &lt;-<span class="st"> </span>q[i<span class="dv">-1</span>]</span>
<span id="cb81-12"><a href="#cb81-12"></a>  r_hat &lt;-<span class="st"> </span>r[i<span class="dv">-1</span>]</span>
<span id="cb81-13"><a href="#cb81-13"></a>  Eaa &lt;-<span class="st"> </span>na<span class="op">*</span>p_hat<span class="op">/</span>(p_hat<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r_hat)</span>
<span id="cb81-14"><a href="#cb81-14"></a>  Ebb &lt;-<span class="st"> </span>nb<span class="op">*</span>q_hat<span class="op">/</span>(q_hat<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r_hat)</span>
<span id="cb81-15"><a href="#cb81-15"></a>  p[i] &lt;-<span class="st"> </span>(Eaa<span class="op">+</span>na<span class="op">+</span>nab)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb81-16"><a href="#cb81-16"></a>  q[i] &lt;-<span class="st"> </span>(Ebb<span class="op">+</span>nb<span class="op">+</span>nab)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb81-17"><a href="#cb81-17"></a>  r[i] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p[i]<span class="op">-</span>q[i]</span>
<span id="cb81-18"><a href="#cb81-18"></a>  E[i] &lt;-<span class="st"> </span>na<span class="op">*</span>p[i]<span class="op">/</span>(p[i]<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r[i])<span class="op">*</span><span class="kw">log</span>(p[i]<span class="op">/</span><span class="dv">2</span><span class="op">/</span>r[i])<span class="op">+</span>na<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[i]<span class="op">*</span>r[i])<span class="op">+</span></span>
<span id="cb81-19"><a href="#cb81-19"></a><span class="st">          </span>nb<span class="op">*</span>q[i]<span class="op">/</span>(q[i]<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r[i])<span class="op">*</span><span class="kw">log</span>(q[i]<span class="op">/</span><span class="dv">2</span><span class="op">/</span>r[i])<span class="op">+</span>nb<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q[i]<span class="op">*</span>r[i])<span class="op">+</span></span>
<span id="cb81-20"><a href="#cb81-20"></a><span class="st">          </span><span class="dv">2</span><span class="op">*</span>noo<span class="op">*</span><span class="kw">log</span>(r[i])<span class="op">+</span>nab<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[i]<span class="op">*</span>q[i])</span>
<span id="cb81-21"><a href="#cb81-21"></a>}</span>
<span id="cb81-22"><a href="#cb81-22"></a><span class="kw">print</span>(<span class="kw">cbind</span>(p,q,r,E))</span></code></pre></div>
<pre><code>##               p         q         r         E
##  [1,] 0.3333333 0.3333333 0.3333333     0.000
##  [2,] 0.3275000 0.1195000 0.5530000 -1458.316
##  [3,] 0.3042185 0.1039357 0.5918457 -1431.961
##  [4,] 0.2988902 0.1028274 0.5982824 -1428.443
##  [5,] 0.2978702 0.1027229 0.5994069 -1427.846
##  [6,] 0.2976825 0.1027090 0.5996085 -1427.739
##  [7,] 0.2976483 0.1027067 0.5996450 -1427.720
##  [8,] 0.2976420 0.1027063 0.5996516 -1427.716
##  [9,] 0.2976409 0.1027063 0.5996528 -1427.716
## [10,] 0.2976407 0.1027063 0.5996530 -1427.716</code></pre>
<div id="from-8th-iterthe-em-algorithm-convergencedand-the-corresponding-log-maximum-likelihood-values-is-increasing-until-convergence." class="section level4">
<h4>From 8th iter,the EM algorithm convergenced,and the corresponding log-maximum likelihood values is increasing until convergence.</h4>
</div>
</div>
<div id="question2-1" class="section level1">
<h1>Question2</h1>
<div id="use-both-for-loops-and-lapply-to-fit-linear-models-to-the-mtcars-using-the-formulas-stored-in-this-list" class="section level4">
<h4>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</h4>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb83-2"><a href="#cb83-2"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb83-3"><a href="#cb83-3"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb83-4"><a href="#cb83-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb83-5"><a href="#cb83-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb83-6"><a href="#cb83-6"></a>)</span></code></pre></div>
</div>
</div>
<div id="answer2-2" class="section level1">
<h1>Answer2</h1>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb84-2"><a href="#cb84-2"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb84-3"><a href="#cb84-3"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb84-4"><a href="#cb84-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb84-5"><a href="#cb84-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb84-6"><a href="#cb84-6"></a>)</span>
<span id="cb84-7"><a href="#cb84-7"></a><span class="co">#use lapply() to fit linear models</span></span>
<span id="cb84-8"><a href="#cb84-8"></a>res_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(x,mtcars))</span>
<span id="cb84-9"><a href="#cb84-9"></a><span class="co">#use loops to fit linear models</span></span>
<span id="cb84-10"><a href="#cb84-10"></a>res_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NULL</span>)</span>
<span id="cb84-11"><a href="#cb84-11"></a><span class="kw">length</span>(res_<span class="dv">2</span>) &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb84-12"><a href="#cb84-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb84-13"><a href="#cb84-13"></a>  res_<span class="dv">2</span>[[i]] &lt;-<span class="st"> </span>(<span class="kw">lm</span>(formulas[[i]],mtcars))</span>
<span id="cb84-14"><a href="#cb84-14"></a>}</span>
<span id="cb84-15"><a href="#cb84-15"></a><span class="co">#output the results</span></span>
<span id="cb84-16"><a href="#cb84-16"></a><span class="kw">print</span>(res_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">print</span>(res_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question3" class="section level1">
<h1>Question3</h1>
<div id="the-following-code-simulates-the-performance-of-a-t-test-for-non-normal-data.-use-sapply-and-an-anonymous-function-to-extract-the-p-value-from-every-trial." class="section level4">
<h4>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</h4>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="dv">100</span>,</span>
<span id="cb88-3"><a href="#cb88-3"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb88-4"><a href="#cb88-4"></a><span class="dt">simplify  =</span>  <span class="ot">FALSE</span></span>
<span id="cb88-5"><a href="#cb88-5"></a>)</span></code></pre></div>
</div>
<div id="extra-challenge-get-rid-of-the-anonymous-function-by-using-directly." class="section level4">
<h4>Extra challenge: get rid of the anonymous function by using [[ directly.</h4>
</div>
</div>
<div id="answer3-1" class="section level1">
<h1>Answer3</h1>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="dv">100</span>,</span>
<span id="cb89-3"><a href="#cb89-3"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb89-5"><a href="#cb89-5"></a>)</span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="co">#use sapply() and an anonymous function to extract the p-value</span></span>
<span id="cb89-7"><a href="#cb89-7"></a>res_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span>
<span id="cb89-8"><a href="#cb89-8"></a><span class="co">#get rid of the anonymous function by using [[ directly</span></span>
<span id="cb89-9"><a href="#cb89-9"></a>res_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials,<span class="st">&quot;[[&quot;</span>,<span class="dv">3</span>)</span>
<span id="cb89-10"><a href="#cb89-10"></a><span class="co"># print the results</span></span>
<span id="cb89-11"><a href="#cb89-11"></a><span class="kw">print</span>(res_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>##   [1] 0.35179220 0.63340347 0.14738367 0.11346330 0.47162422 0.94196010
##   [7] 0.64354593 0.62520446 0.71111059 0.77976485 0.56644136 0.96014836
##  [13] 0.97151302 0.87825229 0.96204790 0.49733959 0.26138711 0.87101301
##  [19] 0.80066524 0.42101355 0.88482748 0.52208035 0.81055179 0.71179551
##  [25] 0.63177013 0.65288570 0.56287664 0.53443227 0.28624727 0.07865916
##  [31] 0.68355184 0.97990110 0.47952687 0.28068639 0.86415317 0.98329418
##  [37] 0.02192270 0.58983303 0.71324810 0.62244937 0.38170431 0.71488586
##  [43] 0.75288808 0.97324397 0.22384047 0.70846951 0.07650281 0.69487618
##  [49] 0.48602686 0.23521185 0.29091816 0.07483880 0.46544928 0.30836776
##  [55] 0.86370150 0.16761655 0.13362763 0.73544889 0.57672817 0.01475997
##  [61] 0.71047789 0.29410215 0.97757907 0.10862868 0.44907311 0.53868737
##  [67] 0.13990350 0.85027776 0.91874995 0.58780893 0.64135469 0.08842626
##  [73] 0.66852044 0.90208939 0.94564689 0.92063829 0.76182371 0.08115031
##  [79] 0.70619475 0.08848733 0.09665063 0.93836772 0.15748043 0.80080372
##  [85] 0.03906554 0.85134612 0.14291436 0.08640771 0.41895969 0.27735219
##  [91] 0.59239130 0.41827806 0.31452200 0.37899820 0.35335080 0.18814829
##  [97] 0.77764428 0.92378799 0.55778763 0.37711323</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="kw">print</span>(res_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##   [1] 0.35179220 0.63340347 0.14738367 0.11346330 0.47162422 0.94196010
##   [7] 0.64354593 0.62520446 0.71111059 0.77976485 0.56644136 0.96014836
##  [13] 0.97151302 0.87825229 0.96204790 0.49733959 0.26138711 0.87101301
##  [19] 0.80066524 0.42101355 0.88482748 0.52208035 0.81055179 0.71179551
##  [25] 0.63177013 0.65288570 0.56287664 0.53443227 0.28624727 0.07865916
##  [31] 0.68355184 0.97990110 0.47952687 0.28068639 0.86415317 0.98329418
##  [37] 0.02192270 0.58983303 0.71324810 0.62244937 0.38170431 0.71488586
##  [43] 0.75288808 0.97324397 0.22384047 0.70846951 0.07650281 0.69487618
##  [49] 0.48602686 0.23521185 0.29091816 0.07483880 0.46544928 0.30836776
##  [55] 0.86370150 0.16761655 0.13362763 0.73544889 0.57672817 0.01475997
##  [61] 0.71047789 0.29410215 0.97757907 0.10862868 0.44907311 0.53868737
##  [67] 0.13990350 0.85027776 0.91874995 0.58780893 0.64135469 0.08842626
##  [73] 0.66852044 0.90208939 0.94564689 0.92063829 0.76182371 0.08115031
##  [79] 0.70619475 0.08848733 0.09665063 0.93836772 0.15748043 0.80080372
##  [85] 0.03906554 0.85134612 0.14291436 0.08640771 0.41895969 0.27735219
##  [91] 0.59239130 0.41827806 0.31452200 0.37899820 0.35335080 0.18814829
##  [97] 0.77764428 0.92378799 0.55778763 0.37711323</code></pre>
</div>
<div id="question-4" class="section level1">
<h1>Question 4</h1>
<div id="implement-a-combination-of-map-and-vapply-to-create-an-lapply-variant-that-iterates-in-parallel-over-all-of-its-inputs-and-stores-its-outputs-in-a-vector-or-a-matrix.-what-arguements-should-the-function-take" class="section level4">
<h4>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguements should the function take?</h4>
</div>
</div>
<div id="answer4" class="section level1">
<h1>Answer4</h1>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>meapply &lt;-<span class="st"> </span><span class="cf">function</span>(x,f,f.value){</span>
<span id="cb93-2"><a href="#cb93-2"></a>  <span class="kw">vapply</span>(x,<span class="cf">function</span>(x) <span class="kw">Map</span>(f,x),f.value)</span>
<span id="cb93-3"><a href="#cb93-3"></a>}</span></code></pre></div>
</div>
<div id="a-20066-2020-12-01" class="section level1">
<h1>A-20066-2020-12-01</h1>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
</div>
<div id="question1-1" class="section level1">
<h1>Question1</h1>
<div id="write-an-rcpp-function-for-exercise-9.4" class="section level4">
<h4>Write an Rcpp function for Exercise 9.4</h4>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="kw">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="kw">cppFunction</span>(<span class="st">&#39;List rwcc(double sigma, double x0, int N) {</span></span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="st">NumericVector x(N) ;</span></span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="st">x[0] = x0;</span></span>
<span id="cb96-4"><a href="#cb96-4"></a><span class="st">NumericVector u ;</span></span>
<span id="cb96-5"><a href="#cb96-5"></a><span class="st">u= runif(N);</span></span>
<span id="cb96-6"><a href="#cb96-6"></a><span class="st">int k = 0;</span></span>
<span id="cb96-7"><a href="#cb96-7"></a><span class="st">for (int i=1;i&lt;N; i+=1) {</span></span>
<span id="cb96-8"><a href="#cb96-8"></a><span class="st">NumericVector y = rnorm(1, x[i-1], sigma);</span></span>
<span id="cb96-9"><a href="#cb96-9"></a><span class="st">if (u[i] &lt;= (exp(-abs(y[0])) / exp(-abs(x[i-1]))))</span></span>
<span id="cb96-10"><a href="#cb96-10"></a><span class="st">{x[i] = y[0] ;</span></span>
<span id="cb96-11"><a href="#cb96-11"></a><span class="st">}else  {</span></span>
<span id="cb96-12"><a href="#cb96-12"></a><span class="st">x[i] = x[i-1];</span></span>
<span id="cb96-13"><a href="#cb96-13"></a><span class="st">k = k + 1;</span></span>
<span id="cb96-14"><a href="#cb96-14"></a><span class="st">} }</span></span>
<span id="cb96-15"><a href="#cb96-15"></a><span class="st">return List::create(Named(&quot;x&quot;) =x, Named(&quot;k&quot;) = k);</span></span>
<span id="cb96-16"><a href="#cb96-16"></a><span class="st">}&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="question2-2" class="section level1">
<h1>Question2</h1>
<div id="compare-the-corresponding-generated-random-numbers-with-those-by-the-r-function-you-wrote-before-using-the-function-qqplot." class="section level4">
<h4>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</h4>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="kw">set.seed</span>(<span class="dv">1321</span>)</span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb99-2"><a href="#cb99-2"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb99-3"><a href="#cb99-3"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb99-4"><a href="#cb99-4"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb99-5"><a href="#cb99-5"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb99-6"><a href="#cb99-6"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb99-7"><a href="#cb99-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb99-8"><a href="#cb99-8"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb99-9"><a href="#cb99-9"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)) <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))))</span>
<span id="cb99-10"><a href="#cb99-10"></a>    x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb99-11"><a href="#cb99-11"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb99-12"><a href="#cb99-12"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb99-13"><a href="#cb99-13"></a>      } </span>
<span id="cb99-14"><a href="#cb99-14"></a>    }</span>
<span id="cb99-15"><a href="#cb99-15"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb99-16"><a href="#cb99-16"></a>}</span>
<span id="cb99-17"><a href="#cb99-17"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb99-18"><a href="#cb99-18"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb99-19"><a href="#cb99-19"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb99-20"><a href="#cb99-20"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb99-21"><a href="#cb99-21"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rwcc</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb99-22"><a href="#cb99-22"></a><span class="kw">qqplot</span>(rw1<span class="op">$</span>x,rw2<span class="op">$</span>x,<span class="dt">xlab =</span> <span class="st">&quot;r&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;c++&quot;</span>)</span>
<span id="cb99-23"><a href="#cb99-23"></a><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question3-1" class="section level1">
<h1>Question3</h1>
<div id="campare-the-computation-time-of-the-two-functions-with-the-function-microbenchmark." class="section level4">
<h4>Campare the computation time of the two functions with the function “microbenchmark”.</h4>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="kw">set.seed</span>(<span class="dv">1425</span>)</span>
<span id="cb100-2"><a href="#cb100-2"></a>ts&lt;-<span class="kw">microbenchmark</span>(<span class="dt">rw1=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N),</span>
<span id="cb100-3"><a href="#cb100-3"></a>                   <span class="dt">rw2=</span><span class="kw">rwcc</span>(sigma[<span class="dv">2</span>], x0, N))</span>
<span id="cb100-4"><a href="#cb100-4"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr     lq  median      uq
## 1  rw1 3142.7 3230.55 3617.80
## 2  rw2  309.0  314.60  344.55</code></pre>
</div>
</div>
<div id="question4" class="section level1">
<h1>Question4</h1>
<div id="comments-your-results." class="section level4">
<h4>Comments your results.</h4>
<p>In question3,we can see the distribution of corresponding generated random numbers with Rccp function and R function are almost the same. In question4,C++ function is faster than R function.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
